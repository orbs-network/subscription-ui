(this["webpackJsonpsubscription-ui"]=this["webpackJsonpsubscription-ui"]||[]).push([[0],{307:function(e,t,n){e.exports=n.p+"static/media/logo-white.e59b3ac9.svg"},328:function(e,t,n){e.exports=n(653)},333:function(e,t,n){},345:function(e,t){},354:function(e,t){},371:function(e,t){},373:function(e,t){},388:function(e,t){},389:function(e,t){},391:function(e,t){},392:function(e,t){},468:function(e,t){},470:function(e,t){},479:function(e,t){},481:function(e,t){},506:function(e,t){},508:function(e,t){},514:function(e,t){},515:function(e,t){},518:function(e,t){},534:function(e,t){},537:function(e,t){},542:function(e,t){},553:function(e,t){},556:function(e,t){},650:function(e,t,n){},653:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(21),i=n.n(o);n(333),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c,s,l,u,d,p,m,h,b,f,v,g,y,O,E,C,w,S,x,j,k,P,A,I,T,M,L,D=n(8),W=n(5),R=n.n(W),N=n(17),B=n(38),F=n(10),V=n(12),_=n(24),U=(n(206),c=Object(D.action)("setWalletConnectionRequestApproved"),s=Object(D.action)("setMainAddress"),l=function(){function e(t){var n=this;Object(F.a)(this,e),this.cryptoWalletConnectionService=t,Object(B.a)(this,"walletConnectionRequestApproved",u,this),Object(B.a)(this,"hasEthereumProvider",d,this),Object(B.a)(this,"hasEventsSupport",p,this),Object(B.a)(this,"mainAddress",m,this),this.addressCheckingInterval=void 0,this.reactionToWalletConnection=void 0,this.hasEthereumProvider=t.hasEthereumProvider,this.hasEventsSupport=t.hasEventsSupport,this.reactionToWalletConnection=Object(D.reaction)((function(){return n.isConnectedToWallet}),function(){var e=Object(N.a)(R.a.mark((function e(t){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&n.readInformationFromConnectedWallet();case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{fireImmediately:!0}),this.hasEthereumProvider&&(this.cryptoWalletConnectionService.hasEventsSupport?this.cryptoWalletConnectionService.onMainAddressChange((function(e){return n.setMainAddress(e)})):(this.cryptoWalletConnectionService.readMainAddress().then((function(e){return n.setMainAddress(e)})),this.addressCheckingInterval=setInterval((function(){return n.cryptoWalletConnectionService.readMainAddress().then((function(e){return n.setMainAddress(e)}))}),1e3)))}return Object(V.a)(e,[{key:"askToConnect",value:function(){var e=Object(N.a)(R.a.mark((function e(){var t;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isConnectedToWallet){e.next=4;break}return e.abrupt("return",!0);case 4:return e.next=6,this.cryptoWalletConnectionService.requestConnectionPermission();case 6:return t=e.sent,this.setWalletConnectionRequestApproved(t),e.abrupt("return",this.walletConnectionRequestApproved);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"readInformationFromConnectedWallet",value:function(){var e=Object(N.a)(R.a.mark((function e(){var t;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.cryptoWalletConnectionService.readMainAddress();case 2:t=e.sent,this.setMainAddress(t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWalletConnectionRequestApproved",value:function(e){this.walletConnectionRequestApproved=e}},{key:"setMainAddress",value:function(e){this.mainAddress=e}},{key:"isConnectedToWallet",get:function(){return this.hasEthereumProvider&&(this.cryptoWalletConnectionService.didUserApproveDappInThePast||this.walletConnectionRequestApproved)}}]),e}(),u=Object(_.a)(l.prototype,"walletConnectionRequestApproved",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d=Object(_.a)(l.prototype,"hasEthereumProvider",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=Object(_.a)(l.prototype,"hasEventsSupport",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=Object(_.a)(l.prototype,"mainAddress",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Object(_.a)(l.prototype,"isConnectedToWallet",[D.computed],Object.getOwnPropertyDescriptor(l.prototype,"isConnectedToWallet"),l.prototype),Object(_.a)(l.prototype,"setWalletConnectionRequestApproved",[c],Object.getOwnPropertyDescriptor(l.prototype,"setWalletConnectionRequestApproved"),l.prototype),Object(_.a)(l.prototype,"setMainAddress",[s],Object.getOwnPropertyDescriptor(l.prototype,"setMainAddress"),l.prototype),l),z={userRejectedRequest:4001,unauthorized:4100,unsupportedMethod:4200},H=n(66),q=n.n(H);function K(e){return parseInt(q.a.utils.fromWei(e,"ether"))}function Y(e){return BigInt(q.a.utils.toWei(e.toString(),"ether"))}var G=(h=Object(D.action)("setContractParametersDoneLoading"),b=Object(D.action)("setContractParametersErrorLoading"),f=Object(D.action)("setDoneLoading"),v=Object(D.action)("setErrorLoading"),g=Object(D.action)("setTxPending"),y=Object(D.action)("setTxCanceled"),O=Object(D.action)("setTxHadError"),E=Object(D.action)("setMSPContractAllowance"),C=Object(D.action)("setMspContractParameters"),w=function(){function e(t,n,a,r){var o=this;Object(F.a)(this,e),this.cryptoWalletIntegrationStore=t,this.orbsTokenService=n,this.monthlySubscriptionPlanService=a,this.subscriptionsService=r,Object(B.a)(this,"contractParametersDoneLoading",S,this),Object(B.a)(this,"contractParametersErrorLoading",x,this),Object(B.a)(this,"doneLoading",j,this),Object(B.a)(this,"errorLoading",k,this),Object(B.a)(this,"txPending",P,this),Object(B.a)(this,"txHadError",A,this),Object(B.a)(this,"txCanceled",I,this),Object(B.a)(this,"isGuardian",T,this),Object(B.a)(this,"mspContractParameters",M,this),Object(B.a)(this,"allowanceToMSPContract",L,this),this.addressChangeReaction=void 0,this.readContractParameters().then((function(){return console.log("MSP contract parameters read success")})),this.addressChangeReaction=Object(D.reaction)((function(){return o.cryptoWalletIntegrationStore.mainAddress}),function(){var e=Object(N.a)(R.a.mark((function e(t){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.setDoneLoading(!1),e.next=3,o.reactToConnectedAddressChanged(t);case 3:o.monthlySubscriptionPlanService.readMonthlyRateInFullOrbs().then((function(e){return console.log({monthlyRate:e})})),o.monthlySubscriptionPlanService.readTier().then((function(e){return console.log({tier:e})})),o.setDoneLoading(!0);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{fireImmediately:!0})}return Object(V.a)(e,[{key:"handlePromievent",value:function(){var e=Object(N.a)(R.a.mark((function e(t){var n,a,r=arguments;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:"A promivent",this.resetTxIndicators(),this.setTxPending(!0),console.log("Waiting for promievent of ".concat(n)),e.prev=4,e.next=7,t;case 7:return a=e.sent,console.log("Got Results for promievent of ".concat(n)),e.abrupt("return",a);case 12:if(e.prev=12,e.t0=e.catch(4),e.t0.code!==z.userRejectedRequest){e.next=18;break}this.setTxCanceled(!0),e.next=19;break;case 18:throw e.t0;case 19:return e.prev=19,this.setTxPending(!1),e.finish(19);case 22:case"end":return e.stop()}}),e,this,[[4,12,19,22]])})));return function(t){return e.apply(this,arguments)}}()},{key:"setAllowanceForStakingContract",value:function(){var e=Object(N.a)(R.a.mark((function e(t){var n,a,r=this;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.monthlySubscriptionPlanService.contractAddress,a=this.orbsTokenService.approve(n,t),this.handlePromievent(a,"setAllowanceForStakingContract").then((function(){return r.readAndSetMSPContractAllowance(r.cryptoWalletIntegrationStore.mainAddress)}));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createNewVc",value:function(){var e=Object(N.a)(R.a.mark((function e(t){var n,a,r,o;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.monthlySubscriptionPlanService.contractAddress,n=this.monthlySubscriptionPlanService.createANewVC(t),e.next=4,this.handlePromievent(n,"createNewVc").then((function(e){return console.log("Add handling of created vc"),console.log({val:e}),e}));case 4:return a=e.sent,e.next=7,this.subscriptionsService.readVcIdFromHistory(a.blockNumber,this.cryptoWalletIntegrationStore.mainAddress);case 7:return r=e.sent,o=r.vcId,this.manuallyReadAccountData(),e.abrupt("return",o);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"extendExistingVcSubscription",value:function(){var e=Object(N.a)(R.a.mark((function e(t){var n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.monthlySubscriptionPlanService.contractAddress,n=this.monthlySubscriptionPlanService.extendSubscription(t),e.next=4,this.handlePromievent(n,"extendExistingVcSubscription").then((function(e){return console.log({val:e}),e}));case 4:e.sent,this.manuallyReadAccountData();case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"reactToConnectedAddressChanged",value:function(){var e=Object(N.a)(R.a.mark((function e(t){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=12;break}return this.setDefaultAccountAddress(t),this.cryptoWalletIntegrationStore.hasEventsSupport&&this.refreshAccountListeners(t),e.prev=3,e.next=6,this.readDataForAccount(t);case 6:e.next=12;break;case 8:e.prev=8,e.t0=e.catch(3),this.failLoadingProcess(e.t0),console.error("Error in reacting to address change in Orbs Account Store",e.t0);case 12:case"end":return e.stop()}}),e,this,[[3,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"setDefaultAccountAddress",value:function(e){this.monthlySubscriptionPlanService.setFromAccount(e),this.subscriptionsService.setFromAccount(e),this.orbsTokenService.setFromAccount(e)}},{key:"readContractParameters",value:function(){var e=Object(N.a)(R.a.mark((function e(){var t,n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.monthlySubscriptionPlanService.readTier();case 3:return t=e.sent,e.next=6,this.monthlySubscriptionPlanService.readMonthlyRateInFullOrbs();case 6:n=e.sent,this.setMspContractParameters({tierName:t,monthlyRateInFullOrbs:n}),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),this.setContractParametersErrorLoading(!0),console.error("Error loading msp contract parameters"),console.error(e.t0);case 15:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"manuallyReadAccountData",value:function(){var e=Object(N.a)(R.a.mark((function e(){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.readDataForAccount(this.cryptoWalletIntegrationStore.mainAddress);case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),this.failLoadingProcess(e.t0),console.error("Error in manually reading address data in Orbs Account Store",e.t0);case 9:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(){return e.apply(this,arguments)}}()},{key:"readDataForAccount",value:function(){var e=Object(N.a)(R.a.mark((function e(t){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.readAndSetMSPContractAllowance(t).catch((function(e){console.error("Error read-n-set MSP contract allowance: ".concat(e))}));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readAndSetMSPContractAllowance",value:function(){var e=Object(N.a)(R.a.mark((function e(t){var n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.orbsTokenService.readAllowance(t,this.monthlySubscriptionPlanService.contractAddress);case 2:n=e.sent,this.setMSPContractAllowance(K(n.toString()));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"refreshAccountListeners",value:function(){var e=Object(N.a)(R.a.mark((function e(t){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.cancelAllCurrentSubscriptions();case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"cancelAllCurrentSubscriptions",value:function(){}},{key:"failLoadingProcess",value:function(e){this.setErrorLoading(!0),this.setDoneLoading(!0)}},{key:"resetTxIndicators",value:function(){this.setTxPending(!1),this.setTxHadError(!1),this.setTxCanceled(!1)}},{key:"setContractParametersDoneLoading",value:function(e){this.contractParametersDoneLoading=e}},{key:"setContractParametersErrorLoading",value:function(e){this.contractParametersErrorLoading=e}},{key:"setDoneLoading",value:function(e){this.doneLoading=e}},{key:"setErrorLoading",value:function(e){this.errorLoading=e}},{key:"setTxPending",value:function(e){this.txPending=e}},{key:"setTxCanceled",value:function(e){this.txCanceled=e}},{key:"setTxHadError",value:function(e){this.txHadError=e}},{key:"setMSPContractAllowance",value:function(e){this.allowanceToMSPContract=e}},{key:"setMspContractParameters",value:function(e){this.mspContractParameters=e}}]),e}(),S=Object(_.a)(w.prototype,"contractParametersDoneLoading",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),x=Object(_.a)(w.prototype,"contractParametersErrorLoading",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),j=Object(_.a)(w.prototype,"doneLoading",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),k=Object(_.a)(w.prototype,"errorLoading",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),P=Object(_.a)(w.prototype,"txPending",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),A=Object(_.a)(w.prototype,"txHadError",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),I=Object(_.a)(w.prototype,"txCanceled",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),T=Object(_.a)(w.prototype,"isGuardian",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),M=Object(_.a)(w.prototype,"mspContractParameters",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{monthlyRateInFullOrbs:0,tierName:""}}}),L=Object(_.a)(w.prototype,"allowanceToMSPContract",[D.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Object(_.a)(w.prototype,"setContractParametersDoneLoading",[h],Object.getOwnPropertyDescriptor(w.prototype,"setContractParametersDoneLoading"),w.prototype),Object(_.a)(w.prototype,"setContractParametersErrorLoading",[b],Object.getOwnPropertyDescriptor(w.prototype,"setContractParametersErrorLoading"),w.prototype),Object(_.a)(w.prototype,"setDoneLoading",[f],Object.getOwnPropertyDescriptor(w.prototype,"setDoneLoading"),w.prototype),Object(_.a)(w.prototype,"setErrorLoading",[v],Object.getOwnPropertyDescriptor(w.prototype,"setErrorLoading"),w.prototype),Object(_.a)(w.prototype,"setTxPending",[g],Object.getOwnPropertyDescriptor(w.prototype,"setTxPending"),w.prototype),Object(_.a)(w.prototype,"setTxCanceled",[y],Object.getOwnPropertyDescriptor(w.prototype,"setTxCanceled"),w.prototype),Object(_.a)(w.prototype,"setTxHadError",[O],Object.getOwnPropertyDescriptor(w.prototype,"setTxHadError"),w.prototype),Object(_.a)(w.prototype,"setMSPContractAllowance",[E],Object.getOwnPropertyDescriptor(w.prototype,"setMSPContractAllowance"),w.prototype),Object(_.a)(w.prototype,"setMspContractParameters",[C],Object.getOwnPropertyDescriptor(w.prototype,"setMspContractParameters"),w.prototype),w);n(608);var J=function(){function e(t){Object(F.a)(this,e),this.ethereum=t,this.web3=void 0,this.hasEthereumProvider=void 0,this.hasEventsSupport=void 0,this.isMetamaskInstalled=void 0,this.isSemiCompliantEthereumProviderInstalled=void 0,this.hasEthereumProvider=void 0!==this.ethereum,this.isMetamaskInstalled=this.hasEthereumProvider&&!!this.ethereum.isMetaMask,this.isSemiCompliantEthereumProviderInstalled=this.hasEthereumProvider&&!this.ethereum.isMetaMask,this.hasEthereumProvider&&(this.web3=new q.a(this.ethereum));var n=this.hasEthereumProvider?this.ethereum.on:void 0;this.hasEventsSupport=void 0!==n&&null!==n}return Object(V.a)(e,[{key:"requestConnectionPermission",value:function(){var e=Object(N.a)(R.a.mark((function e(){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.ethereum.enable();case 3:return e.abrupt("return",!0);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",!1);case 9:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(){return e.apply(this,arguments)}}()},{key:"getIsMainNetwork",value:function(){var e=Object(N.a)(R.a.mark((function e(){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.isMetamaskInstalled&&"1"===this.ethereum.networkVersion);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"readMainAddress",value:function(){var e=Object(N.a)(R.a.mark((function e(){var t,n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=this.web3)||void 0===t?void 0:t.eth.getAccounts();case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=[];case 5:return n=e.t0,e.abrupt("return",n[0]);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"readCurrentBlockNumber",value:function(){var e=Object(N.a)(R.a.mark((function e(){var t;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(null===(t=this.web3)||void 0===t?void 0:t.eth.getBlockNumber())||0);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onMainAddressChange",value:function(e){var t=this;if(!this.hasEventsSupport)throw new Error("Cannot subscribe to events with given Ethereum provider");var n=function(t){return e(t[0])};return this.ethereum.on("accountsChanged",n),function(){t.ethereum.off("accountsChanged",n)}}},{key:"didUserApproveDappInThePast",get:function(){return this.isMetamaskInstalled&&!!this.ethereum.selectedAddress}}]),e}(),X=(Object({NODE_ENV:"production",PUBLIC_URL:"/subscription-ui",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_ETHEREUM_NETWORK,Object({NODE_ENV:"production",PUBLIC_URL:"/subscription-ui",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_INFURA_KEY),$={urlBase:Object({NODE_ENV:"production",PUBLIC_URL:"/subscription-ui",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).PUBLIC_BASE_PATH||"",network:"mainnet",minimalSubscriptionAmount:6200,decimals:18,v2contractsAddressesOverride:{},ETHEREUM_PROVIDER_WS:"wss://mainnet.infura.io/ws/v3/".concat(X),termsOfUseUrl:"https://www.orbs.com/vc-portal-terms-of-use/",privacyPolicyUrl:"https://www.orbs.com/vc-portal-privacy-policy/"},Q=n(300),Z=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0x3b2c72d0d5fc8a7346091f449487cd0a7f0954d6";Object(F.a)(this,e),this.web3=t,this.subscriptionsContract=void 0,this.subscriptionsContract=new this.web3.eth.Contract(Q.abi,n)}return Object(V.a)(e,[{key:"setFromAccount",value:function(e){console.log("Setthing default address",e),this.subscriptionsContract.options.from=e}},{key:"readVcData",value:function(){var e=Object(N.a)(R.a.mark((function e(t){var n,a;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.subscriptionsContract.methods.getVcData(t).call();case 2:return n=e.sent,a=n,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readVcIdFromHistory",value:function(){var e=Object(N.a)(R.a.mark((function e(t,n){var a,r,o,i,c;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.subscriptionsContract.getPastEvents("VcCreated",{address:n,fromBlock:t,toBlock:t});case 2:return a=e.sent,r=a[0],o=r.returnValues,i=o.owner,c=o.vcid,e.abrupt("return",{owner:i,vcId:c});case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),ee=n(301),te=n(302),ne=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0xb2e3e952ba99a3eab76eddf85a2d387e3d9d335b";Object(F.a)(this,e),this.web3=t,this.monthlySubscriptionPlanContractAddress=n,this.monthlySubscriptionContract=void 0,this.monthlySubscriptionContract=new this.web3.eth.Contract(te.abi,n)}return Object(V.a)(e,[{key:"createANewVC",value:function(e){var t=e.name,n=e.amountInFullOrbs,a=e.isCertified,r=e.deploymentSubset,o=Y(n);return this.monthlySubscriptionContract.methods.createVC(t,o.toString(),a,r).send()}},{key:"extendSubscription",value:function(e){var t=e.amountInFullOrbs,n=e.vcId,a=Y(t);return console.log("Extending by amount",a),this.monthlySubscriptionContract.methods.extendSubscription(n,a.toString()).send()}},{key:"setFromAccount",value:function(e){this.monthlySubscriptionContract.options.from=e}},{key:"readMonthlyRateInFullOrbs",value:function(){var e=Object(N.a)(R.a.mark((function e(){var t;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.monthlySubscriptionContract.methods.monthlyRate().call();case 2:return t=e.sent,e.abrupt("return",K(t));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"readTier",value:function(){var e=Object(N.a)(R.a.mark((function e(){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.monthlySubscriptionContract.methods.tier().call());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"contractAddress",get:function(){return this.monthlySubscriptionPlanContractAddress}}]),e}();var ae=n(52),re=n(684),oe=n(136),ie=n(685),ce=n(303),se=n.n(ce),le=n(191),ue=n.n(le),de=se()(ue()({palette:{type:"dark",primary:{main:"#09142c"},secondary:{main:"#74f6fd"},background:{default:"#0a0f25",paper:"#09142c"}},typography:{},overrides:{MuiPaper:{root:{}},MuiTypography:{colorPrimary:{}},MuiLink:{root:{}}}})),pe=n(60),me=n(686),he=n(51);Object(D.configure)({enforceActions:"observed"});var be=Object(re.a)((function(e){return{snackbarInfo:{backgroundColor:de.palette.primary.dark,color:e.palette.getContrastText(de.palette.primary.dark)}}})),fe=function(e){var t;return t=e?new q.a(e):new q.a(new q.a.providers.WebsocketProvider($.ETHEREUM_PROVIDER_WS)),{cryptoWalletIntegrationService:new J(e),subscriptionsService:new Z(t,$.v2contractsAddressesOverride.subscriptionContract),orbsTokenService:new ee.OrbsTokenService(t,$.v2contractsAddressesOverride.erc20Contract),monthlySubscriptionPlanService:new ne(t,$.v2contractsAddressesOverride.monthlySubscriptionPlanDeployedInstance)}}(window.ethereum),ve=function(e,t,n,a){var r=new U(e);return{cryptoWalletIntegrationStore:r,orbsAccountStore:new G(r,n,a,t)}}(fe.cryptoWalletIntegrationService,fe.subscriptionsService,fe.orbsTokenService,fe.monthlySubscriptionPlanService),ge=r.a.memo((function(e){var t=be(),n=(e.children,e.appComponent);return r.a.createElement(r.a.Fragment,null,r.a.createElement(he.a,{basename:$.urlBase},r.a.createElement(ae.b,Object.assign({},ve,fe),r.a.createElement(oe.b,{injectFirst:!0},r.a.createElement(ie.a,{theme:de},r.a.createElement(pe.a,{maxSnack:3,classes:{variantInfo:t.snackbarInfo}},n,r.a.createElement(me.a,null)))))))})),ye=(n(650),n(43)),Oe=n(692),Ee=n(687),Ce=n(693),we=n(307),Se=n.n(we),xe=n(691),je=n(16),ke=n(705),Pe=n(688),Ae=n(689),Ie=n(308),Te=n.n(Ie),Me=[{translationKey:"New Virtual Chain",url:"/new_vc"},{translationKey:"Existing Virtual Chain",url:"/existing_vc"}],Le=function(){return Object(a.useMemo)((function(){return Me.map((function(e){return{url:e.url,label:e.translationKey}}))}),[])},De=n(704),We=Object(re.a)((function(e){return{menuButton:{},typography:{padding:e.spacing(2)},link:{width:"100%",color:"#ffffffb3",transition:"color 0.4s ease-in-out","&:hover":{color:Ne}}}})),Re=r.a.memo((function(e){var t=We(),n=Le();console.log("Render menu");var o=Object(De.a)(!1),i=o.setFalse,c=o.setTrue,s=o.value,l=r.a.useState(null),u=Object(je.a)(l,2),d=u[0],p=u[1],m=Object(a.useCallback)((function(e){c(),p(e.currentTarget)}),[c]),h=Object(a.useCallback)((function(){i(),p(null)}),[i]),b=Object(a.useMemo)((function(){return n.map((function(e,n){var a=e.label,o=e.url;return r.a.createElement(ke.a,{onClick:function(){},key:a+o},r.a.createElement(Ee.a,{onClick:i,component:he.b,key:n,exact:!0,className:t.link,activeStyle:{color:Ne},underline:"none",to:o,variant:"h6",noWrap:!0},a))}))}),[t.link,n,i]),f=s?"links-popover-menu":void 0;return r.a.createElement("div",null,r.a.createElement(Pe.a,{onClick:m,className:t.menuButton,color:"inherit","aria-label":"menu"},r.a.createElement(Te.a,null)),r.a.createElement(Ae.a,{id:f,open:s,anchorEl:d,onClose:h,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"center"}},b))})),Ne="#16faff",Be=Object(re.a)((function(e){return{appBar:{height:"".concat(6,"rem"),paddingTop:"0.5rem",paddingBottom:"0.5rem",boxSizing:"border-box",zIndex:e.zIndex.drawer+1,padding:e.spacing(1)},logo:{width:70},nav:{display:"inherit",flexWrap:"wrap"},toolbar:{paddingRight:0,paddingLeft:0,margin:"auto",width:"90%",maxWidth:"90%",justifyContent:"space-between"},headerButtonsContainer:{display:"flex",alignItems:"center",justifyContent:"flex-end",margin:"auto",width:"90%",maxWidth:"90%"},displayInMetamaskButton:{marginRight:"".concat(e.spacing(3),"px")},movedDown:{paddingTop:48},link:{color:"#ffffffb3",marginLeft:30,transition:"color 0.4s ease-in-out","&:hover":{color:Ne}}}})),Fe=r.a.memo((function(e){var t=Be(),n=Object(ye.a)(),o=Object(xe.a)(n.breakpoints.down("xs")),i=Le(),c=Object(a.useMemo)((function(){return i.map((function(e,n){var a=e.label,o=e.url;return r.a.createElement(Ee.a,{component:he.b,key:n,exact:!0,className:t.link,activeStyle:{color:Ne},underline:"none",to:o,variant:"h6",noWrap:!0},a)}))}),[t.link,i]),s=Object(a.useMemo)((function(){return o?r.a.createElement(Re,null):r.a.createElement("nav",{className:t.nav},c)}),[t.nav,c,o]);return r.a.createElement(Oe.a,{position:"fixed","data-testid":"header",className:t.appBar},r.a.createElement(Ce.a,{className:t.toolbar},r.a.createElement(he.b,{to:"/"},r.a.createElement("img",{className:t.logo,src:Se.a,alt:"Orbs"})),s))})),Ve=n(28),_e=Object(re.a)((function(e){return{page:{height:"100%",width:"fit-content",maxWidth:"100%",boxSizing:"border-box",paddingBottom:"2em"}}})),Ue=r.a.memo((function(e){var t=_e(),n=e.children;return r.a.createElement("div",{className:t.page},n)})),ze=n(149),He=Object(re.a)((function(e){return{contentFitter:{height:"100%",width:"fit-content",maxWidth:"100%"}}})),qe=r.a.memo((function(e){var t=He(),n=e.children,a=Object(ze.a)(e,["children"]);return r.a.createElement("div",Object.assign({className:t.contentFitter},a),n)})),Ke=n(103),Ye=n(700),Ge=n(694),Je=n(702),Xe=n(148),$e=n.n(Xe),Qe=n(152),Ze=n(147),et=n.n(Ze),tt=Object(re.a)((function(e){return{textField:{"& label.Mui-focused":{color:"#f5f5f5"}},phaseInstructionLabel:{width:"max-content",marginBottom:"0.5rem",paddingBottom:"0.1rem"},forControlLabel:{width:"100%","& .MuiFormControlLabel-label":{width:"100%"}},checkBoxes:{},typographyAnimated:{transition:"height 5s, visibility 5s linear, background-color 2s",height:0,visibility:"hidden"},typographyAnimatedShow:{transition:"height 5s, visibility 5s linear, background-color 2s",height:"100%",visibility:"visible"},actionButton:{transition:"background-color 0.4s linear, color 0.2s linear","&:hover":{backgroundColor:e.palette.secondary.light,color:e.palette.getContrastText(e.palette.secondary.light)}}}})),nt=r.a.memo((function(e){var t=tt(),n=e.subscribeNewVC,o=e.disableActionButtons,i=e.allowanceToMSPContract,c=e.setMSPContractAllowance,s=e.monthlyRateInFullOrbs,l=Object(pe.b)().enqueueSnackbar,u=Object(a.useState)(!1),d=Object(je.a)(u,2),p=(d[0],d[1]),m=Object(a.useState)(""),h=Object(je.a)(m,2),b=h[0],f=h[1],v=Object(a.useState)(1),g=Object(je.a)(v,2),y=g[0],O=g[1],E=Object(a.useState)(!1),C=Object(je.a)(E,2),w=(C[0],C[1],Object(a.useState)(!1)),S=Object(je.a)(w,2),x=(S[0],S[1],Object(Ke.a)()),j=x.register,k=x.handleSubmit,P=(x.errors,y*s),A=i>=P,I=Object(a.useCallback)((function(e){if(A){var t={name:e.name,amountInFullOrbs:P,deploymentSubset:e.runOnCanary?"canary":"main",isCertified:e.runOnlyOnCertifiedValidators};n(t)}else l("Before creating a new VC, please approve usage of your ORBS",{variant:"info",preventDuplicate:!0})}),[P,l,A,n]),T=Object(a.useCallback)((function(){c(P)}),[P,c]);return r.a.createElement("form",{onSubmit:k((function(e){return I(e)})),style:{maxWidth:"100%",width:"60ch"}},r.a.createElement(Qe.a,{className:t.phaseInstructionLabel,variant:"body1",color:"secondary"},"1) Fill in your VC details"),r.a.createElement(Ye.a,{autoComplete:"off",InputLabelProps:{style:{pointerEvents:"auto"}},name:"name",label:"VC name",title:"",variant:"outlined",value:b,onChange:function(e){return f(e.target.value)},required:!0,inputRef:j,fullWidth:!0,className:t.textField}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(Ye.a,{select:!0,SelectProps:{native:!0},name:"subscriptionOption",label:"Initial Subscription",title:"",variant:"outlined",value:y,onChange:function(e){p(!0),O(parseInt(e.target.value))},required:!0,inputRef:j,fullWidth:!0,className:t.textField},r.a.createElement("option",{value:1},"1 month - ",1*s," ORBS"),r.a.createElement("option",{value:3},"3 months - ",3*s," ORBS"),r.a.createElement("option",{value:6},"6 months - ",6*s," ORBS")),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(Qe.a,{className:t.phaseInstructionLabel,variant:"body1",color:"secondary"},"2) Allow usage of your ORBS"),r.a.createElement(Qe.a,{variant:"caption"},"Current allowance : ",i,"/",P),r.a.createElement(Ge.a,{className:t.actionButton,variant:"outlined",fullWidth:!0,onClick:T,disabled:o||A,startIcon:A?r.a.createElement(et.a,null):null},A?"Sufficient allowance":"Approve usage of your ORBS"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(Qe.a,{className:t.phaseInstructionLabel,variant:"body1",color:"secondary"},"3) Create your new Virtual chain"),r.a.createElement(Ge.a,{className:t.actionButton,variant:"outlined",fullWidth:!0,type:"submit",disabled:o},"Create new VC"))}));r.a.memo((function(e){var t=e.text,n=e.tooltipText;return r.a.createElement("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"}},t,r.a.createElement(Je.a,{title:n},r.a.createElement($e.a,{style:{marginInlineStart:"0.5rem"}})))}));function at(){var e=r.a.useContext(ae.a);if(!e)throw new Error("Tried to use services before initialising them");return e}function rt(){return r.a.useContext(ae.a)}function ot(){return rt().orbsAccountStore}var it=n(703),ct=n(695),st=n(696),lt=n(697),ut=n(698),dt=n(310),pt=n.n(dt)()((function(e){return{dialogPaper:{"& .MuiDialog-paper":{border:"4px double ".concat(e.palette.secondary.main),boxShadow:"none"}}}})),mt=r.a.memo((function(e){var t=pt(),n=e.open,a=e.onAccept,o=e.onCancel,i=e.title,c=e.contentText,s=e.acceptText,l=e.cancelText;Object(ye.a)();return r.a.createElement(it.a,{className:t.dialogPaper,fullScreen:!1,open:n,onClose:o,"aria-labelledby":"action-confirmation-dialog",maxWidth:"xs",style:{}},r.a.createElement(ct.a,{id:"action-confirmation-dialog-title"},i),r.a.createElement(st.a,null,r.a.createElement(lt.a,null,c)),r.a.createElement(ut.a,null,r.a.createElement(Ge.a,{autoFocus:!0,onClick:o,color:"secondary",variant:"contained"},l||"Cancel"),r.a.createElement(Ge.a,{onClick:a,color:"secondary",autoFocus:!0,variant:"contained"},s||"Accept")))})),ht="/new_vc",bt="/existing_vc",ft="/recover_vc",vt="/vc_created",gt="/vc_extended",yt=Object(ae.c)((function(e){var t=ot(),n=Object(Ve.f)(),o=Object(a.useState)(!1),i=Object(je.a)(o,2),c=(i[0],i[1],Object(a.useState)(!1)),s=Object(je.a)(c,2),l=s[0],u=s[1],d=Object(a.useState)({title:"",content:""}),p=Object(je.a)(d,2),m=p[0],h=p[1],b=Object(a.useState)((function(){return function(){return console.log("Accepted")}})),f=Object(je.a)(b,2),v=f[0],g=f[1],y=(at().monthlySubscriptionPlanService,Object(pe.b)().enqueueSnackbar),O=Object(a.useCallback)((function(e){t.setAllowanceForStakingContract(Y(e))}),[t]),E=Object(a.useCallback)(function(){var e=Object(N.a)(R.a.mark((function e(a){var r;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.createNewVc(a);case 3:r=e.sent,y("VC Created !",{variant:"success"}),n.push("".concat(vt,"/").concat(r)),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0),y("TX Error !",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),[y,n,t]),C=Object(a.useCallback)(function(){var e=Object(N.a)(R.a.mark((function e(t){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t),h({title:"Create new virtual chain ".concat(t.name),content:'Please click "Create" and accept the transaction.',acceptText:"Create",onCancelMessage:"VC creation canceled"}),u(!0),g((function(){return function(){return E(t)}}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[E]),w=Object(a.useCallback)((function(e){h({title:"Set allowance of ".concat(e," ORBS"),content:'Please click "Allow" and accept the transaction.',acceptText:"Allow",onCancelMessage:"Action canceled"}),u(!0),g((function(){return function(){return O(e)}}))}),[O]);return r.a.createElement(Ue,null,r.a.createElement(qe,null,r.a.createElement(nt,{subscribeNewVC:C,allowanceToMSPContract:t.allowanceToMSPContract,setMSPContractAllowance:w,monthlyRateInFullOrbs:t.mspContractParameters.monthlyRateInFullOrbs}),r.a.createElement(mt,{open:l,onAccept:function(){u(!1),v()},onCancel:function(){u(!1),m.onCancelMessage&&y(m.onCancelMessage,{variant:"info",preventDuplicate:!0})},title:m.title,contentText:m.content})))})),Ot=Object(re.a)((function(e){return{textField:{"& label.Mui-focused":{color:"#f5f5f5"}},phaseInstructionLabel:{width:"max-content",marginBottom:"0.5rem",paddingBottom:"0.1rem"},forControlLabel:{width:"100%","& .MuiFormControlLabel-label":{width:"100%"}},checkBoxes:{},typographyAnimated:{transition:"height 5s, visibility 5s linear, background-color 2s",height:0,visibility:"hidden"},typographyAnimatedShow:{transition:"height 5s, visibility 5s linear, background-color 2s",height:"100%",visibility:"visible"},actionButton:{transition:"background-color 0.4s linear, color 0.2s linear","&:hover":{backgroundColor:e.palette.secondary.light,color:e.palette.getContrastText(e.palette.secondary.light)}}}})),Et=r.a.memo((function(e){var t=Ot(),n=e.actionButtonText,o=e.onActionClick,i=Object(a.useState)(""),c=Object(je.a)(i,2),s=c[0],l=c[1],u=Object(Ke.a)(),d=u.register,p=u.handleSubmit,m=(u.errors,Object(a.useCallback)((function(e){o(e.vcId)}),[o]));return r.a.createElement("form",{onSubmit:p((function(e){return m(e)})),style:{maxWidth:"100%",width:"60ch"}},r.a.createElement(Qe.a,{className:t.phaseInstructionLabel,variant:"body1",color:"secondary"},"Please enter your VC Id"),r.a.createElement(Ye.a,{autoComplete:"off",InputLabelProps:{style:{pointerEvents:"auto"}},name:"vcId",label:"Virtual chain ID",title:"",variant:"outlined",value:s,onChange:function(e){return l(e.target.value)},required:!0,inputRef:d,fullWidth:!0,className:t.textField}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(Ge.a,{className:t.actionButton,variant:"outlined",fullWidth:!0,type:"submit"},n))}));function Ct(e){var t=Object(a.useState)(!0),n=Object(je.a)(t,2),r=n[0],o=n[1],i=Object(a.useState)(!1),c=Object(je.a)(i,2),s=c[0],l=c[1],u=Object(a.useState)({id:"",name:"",payedUntil:0}),d=Object(je.a)(u,2),p=d[0],m=d[1],h=at().subscriptionsService,b=Object(a.useCallback)(function(){var e=Object(N.a)(R.a.mark((function e(t){var n,a;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.readVcData(t);case 2:return n=e.sent,a={id:t,name:n.name,payedUntil:parseInt(n.expiresAt)},e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[h]);return Object(a.useEffect)((function(){o(!0),l(!1),b(e).then((function(e){o(!1),m(e)})).catch((function(){o(!1),l(!0)}))}),[b,e]),{errorFindingVc:s,isLoading:r,vcData:p}}var wt,St=n(311),xt=n.n(St),jt=Object(re.a)((function(e){return{textField:{"& label.Mui-focused":{color:"#f5f5f5"}},phaseInstructionLabel:{width:"max-content",marginBottom:"0.5rem",paddingBottom:"0.1rem"},forControlLabel:{width:"100%","& .MuiFormControlLabel-label":{width:"100%"}},checkBoxes:{},typographyAnimated:{transition:"height 5s, visibility 5s linear, background-color 2s",height:0,visibility:"hidden"},typographyAnimatedShow:{transition:"height 5s, visibility 5s linear, background-color 2s",height:"100%",visibility:"visible"},actionButton:{transition:"background-color 0.4s linear, color 0.2s linear","&:hover":{backgroundColor:e.palette.secondary.light,color:e.palette.getContrastText(e.palette.secondary.light)}}}})),kt=r.a.memo((function(e){var t=jt(),n=e.paidUntil,a=e.vcId,o=e.vcName;return console.log({paidUntil:n}),r.a.createElement("form",{style:{display:"flex",flexDirection:"column",alignItems:"center",maxWidth:"100%",width:"60ch",textAlign:"center"}},r.a.createElement(Qe.a,{className:t.phaseInstructionLabel,variant:"h5",color:"secondary"},"Virtual chain ID"),r.a.createElement(Qe.a,{className:t.phaseInstructionLabel,variant:"h6"},a),r.a.createElement(Qe.a,{className:t.phaseInstructionLabel,variant:"h5",color:"secondary"},"Virtual chain Name"),r.a.createElement(Qe.a,{className:t.phaseInstructionLabel,variant:"h6"},o),r.a.createElement(Qe.a,{className:t.phaseInstructionLabel,variant:"h5",color:"secondary"},"Paid Until"),r.a.createElement(Qe.a,{className:t.phaseInstructionLabel,variant:"h6"},xt.a.unix(n).format("MMM DD, YYYY")))})),Pt=Object(re.a)((function(e){return{textField:{"& label.Mui-focused":{color:"#f5f5f5"}},phaseInstructionLabel:{width:"max-content",marginBottom:"0.5rem",paddingBottom:"0.1rem"},forControlLabel:{width:"100%","& .MuiFormControlLabel-label":{width:"100%"}},checkBoxes:{},typographyAnimated:{transition:"height 5s, visibility 5s linear, background-color 2s",height:0,visibility:"hidden"},typographyAnimatedShow:{transition:"height 5s, visibility 5s linear, background-color 2s",height:"100%",visibility:"visible"},actionButton:{transition:"background-color 0.4s linear, color 0.2s linear","&:hover":{backgroundColor:e.palette.secondary.light,color:e.palette.getContrastText(e.palette.secondary.light)}}}})),At=r.a.memo((function(e){var t=Pt(),n=e.extendVcSubscription,o=e.disableActionButtons,i=e.allowanceToMSPContract,c=e.setMSPContractAllowance,s=e.monthlyRateInFullOrbs,l=Object(pe.b)().enqueueSnackbar,u=Object(a.useState)(!1),d=Object(je.a)(u,2),p=(d[0],d[1]),m=Object(a.useState)(""),h=Object(je.a)(m,2),b=(h[0],h[1],Object(a.useState)(1)),f=Object(je.a)(b,2),v=f[0],g=f[1],y=Object(a.useState)(!1),O=Object(je.a)(y,2),E=(O[0],O[1],Object(a.useState)(!1)),C=Object(je.a)(E,2),w=(C[0],C[1],Object(Ke.a)()),S=w.register,x=w.handleSubmit,j=(w.errors,v*s),k=i>=j,P=Object(a.useCallback)((function(e){k?n(j):l("Before extending your VC subscription, please approve usage of your ORBS",{variant:"info",preventDuplicate:!0})}),[k,j,n,l]),A=Object(a.useCallback)((function(){c(j)}),[j,c]);return r.a.createElement("form",{onSubmit:x((function(e){return P(e)})),style:{maxWidth:"100%",width:"60ch"}},r.a.createElement(Qe.a,{className:t.phaseInstructionLabel,variant:"body1",color:"secondary"},"1) Select how many months to extend by"),r.a.createElement(Ye.a,{select:!0,SelectProps:{native:!0},name:"subscriptionOption",label:"Initial Subscription",title:"",variant:"outlined",value:v,onChange:function(e){p(!0),g(parseInt(e.target.value))},required:!0,inputRef:S,fullWidth:!0,className:t.textField},r.a.createElement("option",{value:1},"1 month extension - ",1*s," ORBS"),r.a.createElement("option",{value:3},"3 months extension - ",3*s," ORBS"),r.a.createElement("option",{value:6},"6 months extension - ",6*s," ORBS")),r.a.createElement(Qe.a,{className:t.phaseInstructionLabel,variant:"body1",color:"secondary"},"2) Allow usage of your ORBS"),r.a.createElement(Qe.a,{variant:"caption"},"Current allowance : ",i,"/",j),r.a.createElement(Ge.a,{className:t.actionButton,variant:"outlined",fullWidth:!0,onClick:A,disabled:o||k,startIcon:k?r.a.createElement(et.a,null):null},k?"Sufficient allowance":"Approve usage of your ORBS"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(Qe.a,{className:t.phaseInstructionLabel,variant:"body1",color:"secondary"},"3) Extend your subscription"),r.a.createElement(Ge.a,{className:t.actionButton,variant:"outlined",fullWidth:!0,type:"submit",disabled:o},"Extend VC subscription"))})),It=(r.a.memo((function(e){var t=e.text,n=e.tooltipText;return r.a.createElement("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"}},t,r.a.createElement(Je.a,{title:n},r.a.createElement($e.a,{style:{marginInlineStart:"0.5rem"}})))})),Object(ae.c)((function(e){var t=ot(),n=Object(a.useState)(""),o=Object(je.a)(n,2),i=o[0],c=o[1],s=Object(pe.b)().enqueueSnackbar,l=Ct(i),u=l.vcData,d=l.errorFindingVc,p=l.isLoading,m=Object(Ve.f)(),h=Object(a.useState)(!1),b=Object(je.a)(h,2),f=b[0],v=b[1],g=Object(a.useState)((function(){return function(){return console.log("Accepted")}})),y=Object(je.a)(g,2),O=y[0],E=y[1],C=Object(a.useState)({title:"",content:""}),w=Object(je.a)(C,2),S=w[0],x=w[1],j=Object(a.useCallback)((function(e){c(e)}),[]),k=Object(a.useCallback)((function(e){t.setAllowanceForStakingContract(Y(e))}),[t]),P=Object(a.useCallback)((function(e){x({title:"Set allowance of ".concat(e," ORBS"),content:'Please click "Allow" and accept the transaction.',acceptText:"Allow",onCancelMessage:"Action canceled"}),v(!0),E((function(){return function(){return k(e)}}))}),[k]),A=Object(a.useCallback)(function(){var e=Object(N.a)(R.a.mark((function e(n){var a;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={amountInFullOrbs:n,vcId:i},e.prev=1,e.next=4,t.extendExistingVcSubscription(a);case 4:s("Subscription extended !",{variant:"success"}),m.push("".concat(gt,"/").concat(i)),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(e.t0),s("TX Error !",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),[s,m,t,i]),I=0===i.length,T=Object(a.useMemo)((function(){return I?null:p?r.a.createElement(Qe.a,null,"Loading..."):d?r.a.createElement(Qe.a,{color:"error"},"Error finding Virtual Chain ",i):r.a.createElement(r.a.Fragment,null,r.a.createElement("br",null),r.a.createElement(kt,{paidUntil:u.payedUntil,vcName:u.name,vcId:u.id}),r.a.createElement(At,{monthlyRateInFullOrbs:t.mspContractParameters.monthlyRateInFullOrbs,setMSPContractAllowance:P,allowanceToMSPContract:t.allowanceToMSPContract,extendVcSubscription:A}))}),[d,A,p,t.allowanceToMSPContract,t.mspContractParameters.monthlyRateInFullOrbs,I,P,u.id,u.name,u.payedUntil,i]);return r.a.createElement(Ue,null,I&&r.a.createElement(Et,{onActionClick:j,actionButtonText:"Open"}),T,r.a.createElement(mt,{open:f,onAccept:function(){v(!1),O()},onCancel:function(){v(!1),S.onCancelMessage&&s(S.onCancelMessage,{variant:"info",preventDuplicate:!0})},title:S.title,contentText:S.content}))}))),Tt=r.a.memo((function(e){return r.a.createElement(Ue,null,"Recover VC Page")})),Mt=r.a.memo((function(e){var t=Object(ye.a)(),n=Object(Ve.g)().vcId,a=Ct(n),o=a.vcData,i=a.errorFindingVc;return a.isLoading?r.a.createElement(Ue,null,r.a.createElement(qe,{style:{display:"flex",flexDirection:"column",alignItems:"center"}},r.a.createElement(Qe.a,{variant:"h3",style:{color:t.palette.error.main}},"Loading..."))):i?r.a.createElement(Ue,null,r.a.createElement(qe,{style:{display:"flex",flexDirection:"column",alignItems:"center"}},r.a.createElement(Qe.a,{variant:"h3",style:{color:t.palette.error.main}},"Error finding Virtual chain"),r.a.createElement(Qe.a,{variant:"h3"},n))):r.a.createElement(Ue,null,r.a.createElement(qe,null,r.a.createElement("div",{style:{padding:"0.5rem",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",marginRight:"auto",marginLeft:"auto"}},r.a.createElement(kt,{vcId:n,vcName:o.name,paidUntil:o.payedUntil})," "),r.a.createElement("div",{style:{padding:"0.5rem",width:"fit-content",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"}},r.a.createElement(Qe.a,{variant:"h4",color:"secondary",style:{fontWeight:"bold"}},"Important:"),r.a.createElement(Qe.a,{variant:"h4"},"Please keep the virtual Chain ID for future use."))))})),Lt=r.a.memo((function(e){var t=Object(ye.a)(),n=Object(Ve.g)().vcId,a=Ct(n),o=a.vcData,i=a.errorFindingVc;return a.isLoading?r.a.createElement(Ue,null,r.a.createElement(qe,{style:{display:"flex",flexDirection:"column",alignItems:"center"}},r.a.createElement(Qe.a,{variant:"h3",style:{color:t.palette.error.main}},"Loading..."))):i?r.a.createElement(Ue,null,r.a.createElement(qe,{style:{display:"flex",flexDirection:"column",alignItems:"center"}},r.a.createElement(Qe.a,{variant:"h3",style:{color:t.palette.error.main}},"Error finding Virtual chain"),r.a.createElement(Qe.a,{variant:"h3"},n))):r.a.createElement(Ue,null,r.a.createElement(qe,null,r.a.createElement("div",{style:{padding:"0.5rem",width:"fit-content",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"}},r.a.createElement(Qe.a,{variant:"h4"},"Vc subscription successfully extended !")),r.a.createElement("div",{style:{padding:"0.5rem",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",marginRight:"auto",marginLeft:"auto"}},r.a.createElement(kt,{vcId:n,vcName:o.name,paidUntil:o.payedUntil})," ")))})),Dt=n(699),Wt=n(701),Rt=n(312),Nt=Object(re.a)((function(e){return{link:{color:e.palette.secondary.light,"&:hover":{color:e.palette.secondary.main}}}})),Bt=r.a.memo((function(e){var t=Nt(),n=e.text,a=e.href,o=Object(ze.a)(e,["text","href"]);return r.a.createElement("a",Object.assign({className:t.link,href:a||"",target:"_blank",rel:"noopener noreferrer"},o),n)})),Ft=Object(re.a)((function(e){return{noEthereumProviderSection:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",padding:"2em",backgroundColor:"rgba(0,0,0, 0.2)",borderRadius:"5%",width:"fit-content",maxWidth:"100%",boxSizing:"border-box"}}})),Vt=r.a.memo((function(e){var t=Ft(),n=e.walletConnectionPhase,a=e.actionFunction,o=(e.pressedOnInstall,Object(De.a)(!1)),i="connect"===n,c=!i||o.value,s="install"===n,l=s?"No Ethereum provider detected":"Please connect",u=s?"you should install MetaMask and refresh the page":"To begin, connect your wallet",d="install"===n?"Install":"Connect",p=Object(Rt.renderToString)(r.a.createElement(ie.a,{theme:de},r.a.createElement(Qe.a,null,"I agree to the"," ",r.a.createElement(Bt,{href:$.termsOfUseUrl,text:"Terms of Use"})," and"," ",r.a.createElement(Bt,{href:$.privacyPolicyUrl,text:"Privacy Policy"}))));return r.a.createElement("div",{className:t.noEthereumProviderSection},r.a.createElement(Qe.a,{style:{marginBottom:"0.5rem"},variant:"h4"},l),r.a.createElement(Qe.a,{style:{marginBottom:"1rem"}},u),r.a.createElement(Ge.a,{variant:"outlined",onClick:a,disabled:!c},d),i&&r.a.createElement(Dt.a,{style:{marginTop:"0.5rem"},control:r.a.createElement(Wt.a,{checked:o.value,onChange:function(e){return o.setValue(e.target.checked)},name:"legalTicker"}),label:r.a.createElement(Qe.a,{dangerouslySetInnerHTML:{__html:p}})}))})),_t=Object(re.a)((function(e){return{appMain:{height:"100%",maxWidth:"90%",boxSizing:"border-box",padding:e.spacing(2)},headerSeparator:{height:"".concat(6,"rem")},mainWrapper:{backgroundColor:"#06142e",backgroundRepeat:"repeat-y",backgroundImage:"url(https://www.orbs.com/wp-content/uploads/2019/02/technology-background1.png)",backgroundAttachment:"scroll",backgroundPosition:"top center",minHeight:"calc(100% - ".concat(6,"rem)"),display:"flex",flexDirection:"column",alignItems:"center"},drawer:{width:240,flexShrink:0},drawerPaper:{width:240},drawerContainer:{overflow:"auto"}}})),Ut=Object(ae.c)((function(){var e=_t(),t=Object(ye.a)();console.log(t.palette.secondary);var n=rt().cryptoWalletIntegrationStore,o=n.isConnectedToWallet;console.log({isConnected:o});var i=Object(a.useMemo)((function(){return o?r.a.createElement(Ve.c,null,r.a.createElement(Ve.a,{exact:!0,path:ht,component:yt}),r.a.createElement(Ve.a,{exact:!0,path:bt,component:It}),r.a.createElement(Ve.a,{exact:!0,path:ft,component:Tt}),r.a.createElement(Ve.a,{path:"".concat(vt,"/:vcId"),component:Mt}),r.a.createElement(Ve.a,{path:"".concat(gt,"/:vcId"),component:Lt}),r.a.createElement(Ve.a,{path:"/",component:yt})):r.a.createElement(Ue,null,r.a.createElement(Vt,{walletConnectionPhase:"connect",actionFunction:function(){return n.askToConnect()}}))}),[n,o]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Fe,null),r.a.createElement("div",{className:e.headerSeparator}),r.a.createElement("div",{className:e.mainWrapper},r.a.createElement("main",{className:e.appMain},i)))})),zt=Object(re.a)((function(e){return{appMain:{height:"100%",maxWidth:"90%",boxSizing:"border-box",padding:e.spacing(2)},mainWrapper:{backgroundColor:"#06142e",backgroundRepeat:"repeat-y",backgroundImage:"url(https://www.orbs.com/wp-content/uploads/2019/02/technology-background1.png)",backgroundAttachment:"scroll",backgroundPosition:"top center",minHeight:"100%",display:"flex",flexDirection:"column",alignItems:"center"}}})),Ht=r.a.memo((function(e){var t=zt(),n=Object(De.a)(!1),o=Object(a.useCallback)((function(){window.open("https://metamask.io/","_blank"),n.setTrue()}),[n]);return r.a.createElement("div",{className:t.mainWrapper},r.a.createElement("main",{className:t.appMain},r.a.createElement(Ue,null,r.a.createElement(Vt,{actionFunction:o,pressedOnInstall:n.value,walletConnectionPhase:"install"}))))}));wt=!!window.ethereum?r.a.createElement(Ut,null):r.a.createElement(Ht,null),i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ge,{appComponent:wt})),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[328,1,2]]]);
//# sourceMappingURL=main.799dc742.chunk.js.map