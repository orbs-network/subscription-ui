(this["webpackJsonpsubscription-ui"]=this["webpackJsonpsubscription-ui"]||[]).push([[0],{344:function(e,t,n){},357:function(e,t){},366:function(e,t){},383:function(e,t){},385:function(e,t){},401:function(e,t){},402:function(e,t){},404:function(e,t){},405:function(e,t){},481:function(e,t){},483:function(e,t){},492:function(e,t){},494:function(e,t){},519:function(e,t){},521:function(e,t){},527:function(e,t){},528:function(e,t){},531:function(e,t){},547:function(e,t){},550:function(e,t){},555:function(e,t){},566:function(e,t){},569:function(e,t){},681:function(e,t,n){},688:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n(0),c=n.n(a),o=n(22),i=n.n(o);n(344),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var s,l,u,d,b,p,h,j,m,f,O,v,x,g,y,C,S,w,k,P,A,I,T,E,D,R,L,M,W,N,V,B=n(39),F=n(9),_=n(8),U=n.n(_),z=n(20),H=n(35),q=n(12),K=n(14),Y=n(24),G=(n(217),s=Object(F.action)("setWalletConnectionRequestApproved"),l=Object(F.action)("setMainAddress"),u=function(){function e(t){var n=this;Object(q.a)(this,e),this.cryptoWalletConnectionService=t,Object(H.a)(this,"walletConnectionRequestApproved",d,this),Object(H.a)(this,"hasEthereumProvider",b,this),Object(H.a)(this,"hasEventsSupport",p,this),Object(H.a)(this,"mainAddress",h,this),this.addressCheckingInterval=void 0,this.reactionToWalletConnection=void 0,this.hasEthereumProvider=t.hasEthereumProvider,this.hasEventsSupport=t.hasEventsSupport,this.reactionToWalletConnection=Object(F.reaction)((function(){return n.isConnectedToWallet}),function(){var e=Object(z.a)(U.a.mark((function e(t){return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&n.readInformationFromConnectedWallet();case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{fireImmediately:!0}),this.hasEthereumProvider&&(this.cryptoWalletConnectionService.hasEventsSupport?this.cryptoWalletConnectionService.onMainAddressChange((function(e){return n.setMainAddress(e)})):(this.cryptoWalletConnectionService.readMainAddress().then((function(e){return n.setMainAddress(e)})),this.addressCheckingInterval=setInterval((function(){return n.cryptoWalletConnectionService.readMainAddress().then((function(e){return n.setMainAddress(e)}))}),1e3)))}return Object(K.a)(e,[{key:"askToConnect",value:function(){var e=Object(z.a)(U.a.mark((function e(){var t;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isConnectedToWallet){e.next=4;break}return e.abrupt("return",!0);case 4:return e.next=6,this.cryptoWalletConnectionService.requestConnectionPermission();case 6:return t=e.sent,this.setWalletConnectionRequestApproved(t),e.abrupt("return",this.walletConnectionRequestApproved);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"readInformationFromConnectedWallet",value:function(){var e=Object(z.a)(U.a.mark((function e(){var t;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.cryptoWalletConnectionService.readMainAddress();case 2:t=e.sent,this.setMainAddress(t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWalletConnectionRequestApproved",value:function(e){this.walletConnectionRequestApproved=e}},{key:"setMainAddress",value:function(e){this.mainAddress=e}},{key:"isConnectedToWallet",get:function(){return this.hasEthereumProvider&&(this.cryptoWalletConnectionService.didUserApproveDappInThePast||this.walletConnectionRequestApproved)}}]),e}(),d=Object(Y.a)(u.prototype,"walletConnectionRequestApproved",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),b=Object(Y.a)(u.prototype,"hasEthereumProvider",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=Object(Y.a)(u.prototype,"hasEventsSupport",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=Object(Y.a)(u.prototype,"mainAddress",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Object(Y.a)(u.prototype,"isConnectedToWallet",[F.computed],Object.getOwnPropertyDescriptor(u.prototype,"isConnectedToWallet"),u.prototype),Object(Y.a)(u.prototype,"setWalletConnectionRequestApproved",[s],Object.getOwnPropertyDescriptor(u.prototype,"setWalletConnectionRequestApproved"),u.prototype),Object(Y.a)(u.prototype,"setMainAddress",[l],Object.getOwnPropertyDescriptor(u.prototype,"setMainAddress"),u.prototype),u),J=n(60),X={userRejectedRequest:4001,unauthorized:4100,unsupportedMethod:4200},$=n(71),Q=n.n($);function Z(e){return parseInt(Q.a.utils.fromWei(e,"ether"))}function ee(e){return BigInt(Q.a.utils.toWei(e.toString(),"ether"))}var te=(j=Object(F.action)("setContractParametersDoneLoading"),m=Object(F.action)("setContractParametersErrorLoading"),f=Object(F.action)("setDoneLoading"),O=Object(F.action)("setErrorLoading"),v=Object(F.action)("setTxPending"),x=Object(F.action)("setTxCanceled"),g=Object(F.action)("setTxHadError"),y=Object(F.action)("setMSPContractAllowance"),C=Object(F.action)("setMspContractParameters"),S=Object(F.action)("setVcCreationEvents"),w=Object(F.action)("setVcDataInMap"),k=function(){function e(t,n,r,a){var c=this;Object(q.a)(this,e),this.cryptoWalletIntegrationStore=t,this.orbsTokenService=n,this.monthlySubscriptionPlanService=r,this.subscriptionsService=a,Object(H.a)(this,"contractParametersDoneLoading",P,this),Object(H.a)(this,"contractParametersErrorLoading",A,this),Object(H.a)(this,"doneLoading",I,this),Object(H.a)(this,"errorLoading",T,this),Object(H.a)(this,"txPending",E,this),Object(H.a)(this,"txHadError",D,this),Object(H.a)(this,"txCanceled",R,this),Object(H.a)(this,"isGuardian",L,this),Object(H.a)(this,"mspContractParameters",M,this),Object(H.a)(this,"vcCreationEvents",W,this),Object(H.a)(this,"vcIdToData",N,this),Object(H.a)(this,"allowanceToMSPContract",V,this),this.addressChangeReaction=void 0,this.readContractParameters().then((function(){return console.log("MSP contract parameters read success")})),this.addressChangeReaction=Object(F.reaction)((function(){return c.cryptoWalletIntegrationStore.mainAddress}),function(){var e=Object(z.a)(U.a.mark((function e(t){return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.setDoneLoading(!1),e.next=3,c.reactToConnectedAddressChanged(t);case 3:c.monthlySubscriptionPlanService.readMonthlyRateInFullOrbs().then((function(e){return console.log({monthlyRate:e})})),c.monthlySubscriptionPlanService.readTier().then((function(e){return console.log({tier:e})})),c.setDoneLoading(!0);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{fireImmediately:!0})}return Object(K.a)(e,[{key:"handlePromievent",value:function(){var e=Object(z.a)(U.a.mark((function e(t){var n,r,a=arguments;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:"A promivent",this.resetTxIndicators(),this.setTxPending(!0),console.log("Waiting for promievent of ".concat(n)),e.prev=4,e.next=7,t;case 7:return r=e.sent,console.log("Got Results for promievent of ".concat(n)),e.abrupt("return",r);case 12:if(e.prev=12,e.t0=e.catch(4),e.t0.code!==X.userRejectedRequest){e.next=18;break}this.setTxCanceled(!0),e.next=19;break;case 18:throw e.t0;case 19:return e.prev=19,this.setTxPending(!1),e.finish(19);case 22:case"end":return e.stop()}}),e,this,[[4,12,19,22]])})));return function(t){return e.apply(this,arguments)}}()},{key:"setAllowanceForStakingContract",value:function(){var e=Object(z.a)(U.a.mark((function e(t){var n,r,a=this;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.monthlySubscriptionPlanService.contractAddress,r=this.orbsTokenService.approve(n,t),this.handlePromievent(r,"setAllowanceForStakingContract").then((function(){return a.readAndSetMSPContractAllowance(a.cryptoWalletIntegrationStore.mainAddress)}));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createNewVc",value:function(){var e=Object(z.a)(U.a.mark((function e(t){var n,r,a,c;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.monthlySubscriptionPlanService.contractAddress,n=this.monthlySubscriptionPlanService.createANewVC(t),e.next=4,this.handlePromievent(n,"createNewVc").then((function(e){return console.log("Add handling of created vc"),console.log({val:e}),e}));case 4:return r=e.sent,e.next=7,this.subscriptionsService.readVcIdFromHistory(r.blockNumber,this.cryptoWalletIntegrationStore.mainAddress);case 7:return a=e.sent,c=a.vcId,this.manuallyReadAccountData(),e.abrupt("return",c);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"extendExistingVcSubscription",value:function(){var e=Object(z.a)(U.a.mark((function e(t){var n;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.monthlySubscriptionPlanService.contractAddress,n=this.monthlySubscriptionPlanService.extendSubscription(t),e.next=4,this.handlePromievent(n,"extendExistingVcSubscription").then((function(e){return console.log({val:e}),e}));case 4:e.sent,this.manuallyReadAccountData();case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"reactToConnectedAddressChanged",value:function(){var e=Object(z.a)(U.a.mark((function e(t){return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=12;break}return this.setDefaultAccountAddress(t),this.cryptoWalletIntegrationStore.hasEventsSupport&&this.refreshAccountListeners(t),e.prev=3,e.next=6,this.readDataForAccount(t);case 6:e.next=12;break;case 8:e.prev=8,e.t0=e.catch(3),this.failLoadingProcess(e.t0),console.error("Error in reacting to address change in Orbs Account Store",e.t0);case 12:case"end":return e.stop()}}),e,this,[[3,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"setDefaultAccountAddress",value:function(e){this.monthlySubscriptionPlanService.setFromAccount(e),this.subscriptionsService.setFromAccount(e),this.orbsTokenService.setFromAccount(e)}},{key:"readContractParameters",value:function(){var e=Object(z.a)(U.a.mark((function e(){var t,n;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.monthlySubscriptionPlanService.readTier();case 3:return t=e.sent,e.next=6,this.monthlySubscriptionPlanService.readMonthlyRateInFullOrbs();case 6:n=e.sent,this.setMspContractParameters({tierName:t,monthlyRateInFullOrbs:n}),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),this.setContractParametersErrorLoading(!0),console.error("Error loading msp contract parameters"),console.error(e.t0);case 15:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"manuallyReadAccountData",value:function(){var e=Object(z.a)(U.a.mark((function e(){return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.readDataForAccount(this.cryptoWalletIntegrationStore.mainAddress);case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),this.failLoadingProcess(e.t0),console.error("Error in manually reading address data in Orbs Account Store",e.t0);case 9:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(){return e.apply(this,arguments)}}()},{key:"readDataForAccount",value:function(){var e=Object(z.a)(U.a.mark((function e(t){return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.readAndSetMSPContractAllowance(t).catch((function(e){console.error("Error read-n-set MSP contract allowance: ".concat(e))}));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readAndSetMSPContractAllowance",value:function(){var e=Object(z.a)(U.a.mark((function e(t){var n;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.orbsTokenService.readAllowance(t,this.monthlySubscriptionPlanService.contractAddress);case 2:n=e.sent,this.setMSPContractAllowance(Z(n.toString()));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readDataForAllCreatedVcs",value:function(){var e=Object(z.a)(U.a.mark((function e(){var t,n,r,a;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Object(J.a)(this.vcCreationEvents),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=18;break}return r=n.value,e.prev=5,e.next=8,this.subscriptionsService.readVcData(r.vcId);case 8:a=e.sent,console.log("Setting for ".concat(r.vcId)),this.setVcDataInMap(r.vcId,a),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5),console.error("Error trying reading vc data for ".concat(r.vcId," : ").concat(e.t0));case 16:e.next=3;break;case 18:e.next=23;break;case 20:e.prev=20,e.t1=e.catch(1),t.e(e.t1);case 23:return e.prev=23,t.f(),e.finish(23);case 26:case"end":return e.stop()}}),e,this,[[1,20,23,26],[5,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"refreshAccountListeners",value:function(){var e=Object(z.a)(U.a.mark((function e(t){return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.cancelAllCurrentSubscriptions();case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"cancelAllCurrentSubscriptions",value:function(){}},{key:"setVcCreationEventsAndUpdateVcsData",value:function(e){this.setVcCreationEvents(e),this.readDataForAllCreatedVcs()}},{key:"failLoadingProcess",value:function(e){this.setErrorLoading(!0),this.setDoneLoading(!0)}},{key:"resetTxIndicators",value:function(){this.setTxPending(!1),this.setTxHadError(!1),this.setTxCanceled(!1)}},{key:"setContractParametersDoneLoading",value:function(e){this.contractParametersDoneLoading=e}},{key:"setContractParametersErrorLoading",value:function(e){this.contractParametersErrorLoading=e}},{key:"setDoneLoading",value:function(e){this.doneLoading=e}},{key:"setErrorLoading",value:function(e){this.errorLoading=e}},{key:"setTxPending",value:function(e){this.txPending=e}},{key:"setTxCanceled",value:function(e){this.txCanceled=e}},{key:"setTxHadError",value:function(e){this.txHadError=e}},{key:"setMSPContractAllowance",value:function(e){this.allowanceToMSPContract=e}},{key:"setMspContractParameters",value:function(e){this.mspContractParameters=e}},{key:"setVcCreationEvents",value:function(e){this.vcCreationEvents=e}},{key:"setVcDataInMap",value:function(e,t){this.vcIdToData.set(e,t)}}]),e}(),P=Object(Y.a)(k.prototype,"contractParametersDoneLoading",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),A=Object(Y.a)(k.prototype,"contractParametersErrorLoading",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),I=Object(Y.a)(k.prototype,"doneLoading",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),T=Object(Y.a)(k.prototype,"errorLoading",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),E=Object(Y.a)(k.prototype,"txPending",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),D=Object(Y.a)(k.prototype,"txHadError",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),R=Object(Y.a)(k.prototype,"txCanceled",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),L=Object(Y.a)(k.prototype,"isGuardian",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),M=Object(Y.a)(k.prototype,"mspContractParameters",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{monthlyRateInFullOrbs:0,tierName:""}}}),W=Object(Y.a)(k.prototype,"vcCreationEvents",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),N=Object(Y.a)(k.prototype,"vcIdToData",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return F.observable.map()}}),V=Object(Y.a)(k.prototype,"allowanceToMSPContract",[F.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Object(Y.a)(k.prototype,"setContractParametersDoneLoading",[j],Object.getOwnPropertyDescriptor(k.prototype,"setContractParametersDoneLoading"),k.prototype),Object(Y.a)(k.prototype,"setContractParametersErrorLoading",[m],Object.getOwnPropertyDescriptor(k.prototype,"setContractParametersErrorLoading"),k.prototype),Object(Y.a)(k.prototype,"setDoneLoading",[f],Object.getOwnPropertyDescriptor(k.prototype,"setDoneLoading"),k.prototype),Object(Y.a)(k.prototype,"setErrorLoading",[O],Object.getOwnPropertyDescriptor(k.prototype,"setErrorLoading"),k.prototype),Object(Y.a)(k.prototype,"setTxPending",[v],Object.getOwnPropertyDescriptor(k.prototype,"setTxPending"),k.prototype),Object(Y.a)(k.prototype,"setTxCanceled",[x],Object.getOwnPropertyDescriptor(k.prototype,"setTxCanceled"),k.prototype),Object(Y.a)(k.prototype,"setTxHadError",[g],Object.getOwnPropertyDescriptor(k.prototype,"setTxHadError"),k.prototype),Object(Y.a)(k.prototype,"setMSPContractAllowance",[y],Object.getOwnPropertyDescriptor(k.prototype,"setMSPContractAllowance"),k.prototype),Object(Y.a)(k.prototype,"setMspContractParameters",[C],Object.getOwnPropertyDescriptor(k.prototype,"setMspContractParameters"),k.prototype),Object(Y.a)(k.prototype,"setVcCreationEvents",[S],Object.getOwnPropertyDescriptor(k.prototype,"setVcCreationEvents"),k.prototype),Object(Y.a)(k.prototype,"setVcDataInMap",[w],Object.getOwnPropertyDescriptor(k.prototype,"setVcDataInMap"),k.prototype),k);n(620);Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_ETHEREUM_NETWORK;var ne=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_INFURA_KEY,re={urlBase:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).PUBLIC_BASE_PATH||"",network:"mainnet",minimalSubscriptionAmount:6200,decimals:18,v2contractsAddressesOverride:{},ETHEREUM_PROVIDER_WS:"wss://mainnet.infura.io/ws/v3/".concat(ne),termsOfUseUrl:"https://www.orbs.com/vc-portal-terms-of-use/",privacyPolicyUrl:"https://www.orbs.com/vc-portal-privacy-policy/"},ae=n(72);var ce=n(48),oe=n(720),ie=n(145),se=n(721),le=n(316),ue=n.n(le),de=n(202),be=n.n(de),pe=ue()(be()({palette:{type:"dark",primary:{main:"#09142c"},secondary:{main:"#74f6fd"},background:{default:"#0a0f25",paper:"#09142c"}},typography:{},overrides:{MuiPaper:{root:{}},MuiTypography:{colorPrimary:{}},MuiLink:{root:{}}}})),he=n(65),je=n(722),me=n(51),fe=n(29),Oe=n(132);Object(F.configure)({enforceActions:"observed"});var ve=Object(oe.a)((function(e){return{snackbarInfo:{backgroundColor:pe.palette.primary.dark,color:e.palette.getContrastText(pe.palette.primary.dark)}}})),xe=function(e){var t;return t=e?new Q.a(e):new Q.a(new Q.a.providers.WebsocketProvider(re.ETHEREUM_PROVIDER_WS)),{cryptoWalletIntegrationService:new ae.CryptoWalletConnectionService(e),subscriptionsService:new ae.SubscriptionsService(t,re.v2contractsAddressesOverride.subscriptionContract),orbsTokenService:new ae.OrbsTokenService(t,re.v2contractsAddressesOverride.erc20Contract),monthlySubscriptionPlanService:new ae.MonthlySubscriptionPlanService(t,re.v2contractsAddressesOverride.monthlySubscriptionPlanDeployedInstance)}}(window.ethereum),ge=function(e,t,n,r){var a=new G(e);return{cryptoWalletIntegrationStore:a,orbsAccountStore:new te(a,n,r,t)}}(xe.cryptoWalletIntegrationService,xe.subscriptionsService,xe.orbsTokenService,xe.monthlySubscriptionPlanService),ye=c.a.memo((function(e){var t=ve(),n=(e.children,e.appComponent);return Object(r.jsx)(r.Fragment,{children:Object(r.jsx)(me.a,{children:Object(r.jsx)(Oe.a,{ReactRouterRoute:fe.a,children:Object(r.jsx)(ce.b,Object(B.a)(Object(B.a)(Object(B.a)({},ge),xe),{},{children:Object(r.jsx)(ie.b,{injectFirst:!0,children:Object(r.jsx)(se.a,{theme:pe,children:Object(r.jsxs)(he.a,{maxSnack:3,classes:{variantInfo:t.snackbarInfo},children:[n,Object(r.jsx)(je.a,{})]})})})}))})})})})),Ce=(n(681),n(47)),Se=n(728),we=n(723),ke=n(729),Pe=n.p+"static/media/logo-white.9892bf0f.svg",Ae=n(727),Ie=n(16),Te=n(744),Ee=n(724),De=n(725),Re=n(320),Le=n.n(Re),Me=[{translationKey:"New Virtual Chain",url:"/new_vc"},{translationKey:"Existing Virtual Chain",url:"/existing_vc"},{translationKey:"Recover Virtual Chain",url:"/recover_vc"}],We=function(){return Object(a.useMemo)((function(){return Me.map((function(e){return{url:e.url,label:e.translationKey}}))}),[])},Ne=n(743),Ve=Object(oe.a)((function(e){return{menuButton:{},typography:{padding:e.spacing(2)},link:{width:"100%",color:"#ffffffb3",transition:"color 0.4s ease-in-out","&:hover":{color:Fe}}}})),Be=c.a.memo((function(e){var t=Ve(),n=We();console.log("Render menu");var o=Object(Ne.a)(!1),i=o.setFalse,s=o.setTrue,l=o.value,u=c.a.useState(null),d=Object(Ie.a)(u,2),b=d[0],p=d[1],h=Object(a.useCallback)((function(e){s(),p(e.currentTarget)}),[s]),j=Object(a.useCallback)((function(){i(),p(null)}),[i]),m=Object(a.useMemo)((function(){return n.map((function(e,n){var a=e.label,c=e.url;return Object(r.jsx)(Te.a,{onClick:function(){},children:Object(r.jsx)(we.a,{onClick:i,component:me.b,exact:!0,className:t.link,activeStyle:{color:Fe},underline:"none",to:c,variant:"h6",noWrap:!0,children:a},n)},a+c)}))}),[t.link,n,i]),f=l?"links-popover-menu":void 0;return Object(r.jsxs)("div",{children:[Object(r.jsx)(Ee.a,{onClick:h,className:t.menuButton,color:"inherit","aria-label":"menu",children:Object(r.jsx)(Le.a,{})}),Object(r.jsx)(De.a,{id:f,open:l,anchorEl:b,onClose:j,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"center"},children:m})]})})),Fe="#16faff",_e=Object(oe.a)((function(e){return{appBar:{height:"".concat(6,"rem"),paddingTop:"0.5rem",paddingBottom:"0.5rem",boxSizing:"border-box",zIndex:e.zIndex.drawer+1,padding:e.spacing(1)},logo:{width:70},nav:{display:"inherit",flexWrap:"wrap"},toolbar:{paddingRight:0,paddingLeft:0,margin:"auto",width:"90%",maxWidth:"90%",justifyContent:"space-between"},headerButtonsContainer:{display:"flex",alignItems:"center",justifyContent:"flex-end",margin:"auto",width:"90%",maxWidth:"90%"},displayInMetamaskButton:{marginRight:"".concat(e.spacing(3),"px")},movedDown:{paddingTop:48},link:{color:"#ffffffb3",marginLeft:30,transition:"color 0.4s ease-in-out","&:hover":{color:Fe}}}})),Ue=c.a.memo((function(e){var t=_e(),n=Object(Ce.a)(),c=Object(Ae.a)(n.breakpoints.down("xs")),o=We(),i=Object(a.useMemo)((function(){return o.map((function(e,n){var a=e.label,c=e.url;return Object(r.jsx)(we.a,{component:me.b,exact:!0,className:t.link,activeStyle:{color:Fe},underline:"none",to:c,variant:"h6",noWrap:!0,children:a},n)}))}),[t.link,o]),s=Object(a.useMemo)((function(){return c?Object(r.jsx)(Be,{}):Object(r.jsx)("nav",{className:t.nav,children:i})}),[t.nav,i,c]);return Object(r.jsx)(Se.a,{position:"fixed","data-testid":"header",className:t.appBar,children:Object(r.jsxs)(ke.a,{className:t.toolbar,children:[Object(r.jsx)(me.b,{to:"/",children:Object(r.jsx)("img",{className:t.logo,src:Pe,alt:"Orbs"})}),s]})})})),ze=n(83),He=Object(oe.a)((function(e){return{page:{height:"100%",width:"60rem",maxWidth:"100%",boxSizing:"border-box",paddingBottom:"2em",display:"flex",flexDirection:"column",alignItems:"center"}}})),qe=c.a.memo((function(e){var t=He(),n=e.children,a=Object(ze.a)(e,["children"]);return Object(r.jsx)("div",Object(B.a)(Object(B.a)({className:t.page},a),{},{children:n}))})),Ke=Object(oe.a)((function(e){return{contentFitter:{height:"100%",width:"fit-content",maxWidth:"100%"}}})),Ye=c.a.memo((function(e){var t=Ke(),n=e.children,a=Object(ze.a)(e,["children"]);return Object(r.jsx)("div",Object(B.a)(Object(B.a)({className:t.contentFitter},a),{},{children:n}))})),Ge=n(113),Je=n(739),Xe=n(730),$e=n(740),Qe=n(731),Ze=n(741),et=n(157),tt=n.n(et),nt=n(162),rt=n(156),at=n.n(rt),ct=Object(oe.a)((function(e){return{textField:{"& label.Mui-focused":{color:"#f5f5f5"}},phaseInstructionLabel:{width:"max-content",marginBottom:"0.5rem",paddingBottom:"0.1rem"},forControlLabel:{width:"100%","& .MuiFormControlLabel-label":{width:"100%"}},checkBoxes:{},typographyAnimated:{transition:"height 5s, visibility 5s linear, background-color 2s",height:0,visibility:"hidden"},typographyAnimatedShow:{transition:"height 5s, visibility 5s linear, background-color 2s",height:"100%",visibility:"visible"},actionButton:{transition:"background-color 0.4s linear, color 0.2s linear","&:hover":{backgroundColor:e.palette.secondary.light,color:e.palette.getContrastText(e.palette.secondary.light)}}}})),ot=c.a.memo((function(e){var t=ct(),n=e.subscribeNewVC,c=e.disableActionButtons,o=e.allowanceToMSPContract,i=e.setMSPContractAllowance,s=e.subscriptionsLengthsOptions,l=e.monthlyRateInFullOrbs,u=Object(he.b)().enqueueSnackbar,d=Object(a.useState)(!1),b=Object(Ie.a)(d,2),p=(b[0],b[1]),h=Object(a.useState)(""),j=Object(Ie.a)(h,2),m=j[0],f=j[1],O=Object(a.useState)(s[0]),v=Object(Ie.a)(O,2),x=v[0],g=v[1],y=Object(a.useState)(!1),C=Object(Ie.a)(y,2),S=(C[0],C[1],Object(a.useState)(!1)),w=Object(Ie.a)(S,2),k=w[0],P=w[1],A=Object(Ge.a)(),I=A.register,T=A.handleSubmit,E=(A.errors,x*l);console.log({currentCostOfPlan:E});var D=o>=E,R=Object(a.useCallback)((function(e){if(D){var t=ae.MONTHLY_SUBSCRIPTION_PLAN_SERVICE_CONSTANTS.deploymentSubsets,r={name:e.name,amountInFullOrbs:E,deploymentSubset:e.runOnCanary?t.canary:t.main,isCertified:e.runOnlyOnCertifiedValidators};n(r)}else u("Before creating a new VC, please approve usage of your ORBS",{variant:"info",preventDuplicate:!0})}),[E,u,D,n]),L=Object(a.useCallback)((function(){i(E)}),[E,i]);return Object(r.jsxs)("form",{onSubmit:T((function(e){return R(e)})),style:{maxWidth:"100%",width:"60ch"},children:[Object(r.jsx)(nt.a,{className:t.phaseInstructionLabel,variant:"body1",color:"secondary",children:"1) Fill in your VC details"}),Object(r.jsx)(Je.a,{autoComplete:"off",InputLabelProps:{style:{pointerEvents:"auto"}},name:"name",label:"VC name",title:"",variant:"outlined",value:m,onChange:function(e){return f(e.target.value)},required:!0,inputRef:I,fullWidth:!0,className:t.textField}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)(Je.a,{select:!0,SelectProps:{native:!0},name:"subscriptionOption",label:"Initial Subscription",title:"",variant:"outlined",value:x,onChange:function(e){p(!0),g(parseInt(e.target.value))},required:!0,inputRef:I,fullWidth:!0,className:t.textField,children:s.map((function(e){return Object(r.jsxs)("option",{value:e,children:[e," month",1!==e?"s":""," -"," ",(l*e).toLocaleString()," ORBS"]},e)}))}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)(Xe.a,{className:t.forControlLabel,control:Object(r.jsx)($e.a,{className:t.checkBoxes,checked:k,onChange:function(e){return P(e.target.checked)},name:"runOnCanary",inputRef:I}),label:Object(r.jsx)(it,{text:"Run unstable early releases",tooltipText:""})}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)(nt.a,{className:t.phaseInstructionLabel,variant:"body1",color:"secondary",children:"2) Allow usage of your ORBS"}),Object(r.jsxs)(nt.a,{variant:"caption",children:["Current allowance : ",o.toLocaleString()," ORBS | Cost : ",E.toLocaleString()," ORBS"]}),Object(r.jsx)(Qe.a,{className:t.actionButton,variant:"outlined",fullWidth:!0,onClick:L,disabled:c||D,startIcon:D?Object(r.jsx)(at.a,{}):null,children:D?"Sufficient allowance":"Approve usage of your ORBS"}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)(nt.a,{className:t.phaseInstructionLabel,variant:"body1",color:"secondary",children:"3) Create your new Virtual chain"}),Object(r.jsx)(Qe.a,{className:t.actionButton,variant:"outlined",fullWidth:!0,type:"submit",disabled:c,children:"Create new VC"})]})})),it=c.a.memo((function(e){var t=e.text,n=e.tooltipText;return Object(r.jsxs)("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t,Object(r.jsx)(Ze.a,{title:n,children:Object(r.jsx)(tt.a,{style:{marginInlineStart:"0.5rem"}})})]})}));function st(){var e=c.a.useContext(ce.a);if(!e)throw new Error("Tried to use services before initialising them");return e}function lt(){return st().subscriptionsService}function ut(){return c.a.useContext(ce.a)}function dt(){return ut().cryptoWalletIntegrationStore}function bt(){return ut().orbsAccountStore}var pt=n(742),ht=n(732),jt=n(733),mt=n(734),ft=n(735),Ot=n(158),vt=n.n(Ot),xt=vt()((function(e){return{dialogPaper:{"& .MuiDialog-paper":{border:"4px double ".concat(e.palette.secondary.main),boxShadow:"none"}}}})),gt=c.a.memo((function(e){var t=xt(),n=e.open,a=e.onAccept,c=e.onCancel,o=e.title,i=e.contentText,s=e.acceptText,l=e.cancelText;Object(Ce.a)();return Object(r.jsxs)(pt.a,{className:t.dialogPaper,fullScreen:!1,open:n,onClose:c,"aria-labelledby":"action-confirmation-dialog",maxWidth:"xs",style:{},children:[Object(r.jsx)(ht.a,{id:"action-confirmation-dialog-title",children:o}),Object(r.jsx)(jt.a,{children:Object(r.jsx)(mt.a,{children:i})}),Object(r.jsxs)(ft.a,{children:[Object(r.jsx)(Qe.a,{autoFocus:!0,onClick:c,color:"secondary",variant:"contained",children:l||"Cancel"}),Object(r.jsx)(Qe.a,{onClick:a,color:"secondary",autoFocus:!0,variant:"contained",children:s||"Accept"})]})]})})),yt="/new_vc",Ct="/existing_vc",St="/recover_vc",wt="/vc_created",kt="/vc_extended",Pt=Object(ce.c)((function(e){var t=bt(),n=Object(fe.f)(),c=Object(a.useState)(!1),o=Object(Ie.a)(c,2),i=(o[0],o[1],Object(a.useState)(!1)),s=Object(Ie.a)(i,2),l=s[0],u=s[1],d=Object(a.useState)({title:"",content:""}),b=Object(Ie.a)(d,2),p=b[0],h=b[1],j=Object(a.useState)((function(){return function(){return console.log("Accepted")}})),m=Object(Ie.a)(j,2),f=m[0],O=m[1],v=(st().monthlySubscriptionPlanService,Object(he.b)().enqueueSnackbar),x=Object(a.useCallback)((function(e){t.setAllowanceForStakingContract(ee(e))}),[t]),g=Object(a.useCallback)(function(){var e=Object(z.a)(U.a.mark((function e(r){var a;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.createNewVc(r);case 3:a=e.sent,v("VC Created !",{variant:"success"}),n.push("".concat(wt,"/").concat(a)),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0),v("TX Error !",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),[v,n,t]),y=Object(a.useCallback)(function(){var e=Object(z.a)(U.a.mark((function e(t){return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t),h({title:"Create new virtual chain ".concat(t.name),content:'Please click "Create" and accept the transaction.',acceptText:"Create",onCancelMessage:"VC creation canceled"}),u(!0),O((function(){return function(){return g(t)}}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[g]),C=Object(a.useCallback)((function(e){h({title:"Set allowance of ".concat(e," ORBS"),content:'Please click "Allow" and accept the transaction.',acceptText:"Allow",onCancelMessage:"Action canceled"}),u(!0),O((function(){return function(){return x(e)}}))}),[x]);return Object(r.jsx)(qe,{children:Object(r.jsxs)(Ye,{children:[Object(r.jsx)(ot,{subscribeNewVC:y,allowanceToMSPContract:t.allowanceToMSPContract,setMSPContractAllowance:C,monthlyRateInFullOrbs:t.mspContractParameters.monthlyRateInFullOrbs,subscriptionsLengthsOptions:[6,12,18],disableActionButtons:t.txPending}),Object(r.jsx)(gt,{open:l,onAccept:function(){u(!1),f()},onCancel:function(){u(!1),p.onCancelMessage&&v(p.onCancelMessage,{variant:"info",preventDuplicate:!0})},title:p.title,contentText:p.content})]})})})),At=Object(oe.a)((function(e){return{textField:{"& label.Mui-focused":{color:"#f5f5f5"}},phaseInstructionLabel:{width:"max-content",marginBottom:"0.5rem",paddingBottom:"0.1rem"},forControlLabel:{width:"100%","& .MuiFormControlLabel-label":{width:"100%"}},checkBoxes:{},typographyAnimated:{transition:"height 5s, visibility 5s linear, background-color 2s",height:0,visibility:"hidden"},typographyAnimatedShow:{transition:"height 5s, visibility 5s linear, background-color 2s",height:"100%",visibility:"visible"},actionButton:{transition:"background-color 0.4s linear, color 0.2s linear","&:hover":{backgroundColor:e.palette.secondary.light,color:e.palette.getContrastText(e.palette.secondary.light)}}}})),It=c.a.memo((function(e){var t=At(),n=e.actionButtonText,c=e.onActionClick,o=Object(a.useState)(""),i=Object(Ie.a)(o,2),s=i[0],l=i[1],u=Object(Ge.a)(),d=u.register,b=u.handleSubmit,p=(u.errors,Object(a.useCallback)((function(e){c(e.vcId)}),[c]));return Object(r.jsxs)("form",{onSubmit:b((function(e){return p(e)})),style:{maxWidth:"100%",width:"60ch"},children:[Object(r.jsx)(nt.a,{className:t.phaseInstructionLabel,variant:"body1",color:"secondary",children:"Please enter your VC Id"}),Object(r.jsx)(Je.a,{autoComplete:"off",InputLabelProps:{style:{pointerEvents:"auto"}},name:"vcId",label:"Virtual chain ID",title:"",variant:"outlined",value:s,onChange:function(e){return l(e.target.value)},required:!0,inputRef:d,fullWidth:!0,className:t.textField}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)(Qe.a,{className:t.actionButton,variant:"outlined",fullWidth:!0,type:"submit",children:n})]})})),Tt=n(322),Et=n.n(Tt),Dt=Object(oe.a)((function(e){return{textField:{"& label.Mui-focused":{color:"#f5f5f5"}},phaseInstructionLabel:{width:"max-content",marginBottom:"0.5rem",paddingBottom:"0.1rem"},forControlLabel:{width:"100%","& .MuiFormControlLabel-label":{width:"100%"}},checkBoxes:{},typographyAnimated:{transition:"height 5s, visibility 5s linear, background-color 2s",height:0,visibility:"hidden"},typographyAnimatedShow:{transition:"height 5s, visibility 5s linear, background-color 2s",height:"100%",visibility:"visible"},actionButton:{transition:"background-color 0.4s linear, color 0.2s linear","&:hover":{backgroundColor:e.palette.secondary.light,color:e.palette.getContrastText(e.palette.secondary.light)}}}})),Rt=c.a.memo((function(e){var t=Dt(),n=e.paidUntil,a=e.vcId,c=e.vcName,o=e.deploymentSubset;return console.log({paidUntil:n}),Object(r.jsxs)("form",{style:{display:"flex",flexDirection:"column",alignItems:"center",maxWidth:"100%",width:"60ch",textAlign:"center"},children:[Object(r.jsx)(nt.a,{className:t.phaseInstructionLabel,variant:"h5",color:"secondary",children:"Virtual chain ID"}),Object(r.jsx)(nt.a,{className:t.phaseInstructionLabel,variant:"h6",children:a}),Object(r.jsx)(nt.a,{className:t.phaseInstructionLabel,variant:"h5",color:"secondary",children:"Virtual chain Name"}),Object(r.jsx)(nt.a,{className:t.phaseInstructionLabel,variant:"h6",children:c}),Object(r.jsx)(nt.a,{className:t.phaseInstructionLabel,variant:"h5",color:"secondary",children:"Deployment Subset"}),Object(r.jsx)(nt.a,{className:t.phaseInstructionLabel,variant:"h6",children:o}),Object(r.jsx)(nt.a,{className:t.phaseInstructionLabel,variant:"h5",color:"secondary",children:"Paid Until"}),Object(r.jsx)(nt.a,{className:t.phaseInstructionLabel,variant:"h6",children:Et.a.unix(n).format("MMM DD, YYYY")})]})})),Lt=Object(oe.a)((function(e){return{textField:{"& label.Mui-focused":{color:"#f5f5f5"}},phaseInstructionLabel:{width:"max-content",marginBottom:"0.5rem",paddingBottom:"0.1rem"},forControlLabel:{width:"100%","& .MuiFormControlLabel-label":{width:"100%"}},checkBoxes:{},typographyAnimated:{transition:"height 5s, visibility 5s linear, background-color 2s",height:0,visibility:"hidden"},typographyAnimatedShow:{transition:"height 5s, visibility 5s linear, background-color 2s",height:"100%",visibility:"visible"},actionButton:{transition:"background-color 0.4s linear, color 0.2s linear","&:hover":{backgroundColor:e.palette.secondary.light,color:e.palette.getContrastText(e.palette.secondary.light)}}}})),Mt=c.a.memo((function(e){var t=Lt(),n=e.extendVcSubscription,c=e.disableActionButtons,o=e.allowanceToMSPContract,i=e.setMSPContractAllowance,s=e.monthlyRateInFullOrbs,l=Object(he.b)().enqueueSnackbar,u=Object(a.useState)(!1),d=Object(Ie.a)(u,2),b=(d[0],d[1]),p=Object(a.useState)(""),h=Object(Ie.a)(p,2),j=(h[0],h[1],Object(a.useState)(1)),m=Object(Ie.a)(j,2),f=m[0],O=m[1],v=Object(a.useState)(!1),x=Object(Ie.a)(v,2),g=(x[0],x[1],Object(a.useState)(!1)),y=Object(Ie.a)(g,2),C=(y[0],y[1],Object(Ge.a)()),S=C.register,w=C.handleSubmit,k=(C.errors,f*s),P=o>=k,A=Object(a.useCallback)((function(e){P?n(k):l("Before extending your VC subscription, please approve usage of your ORBS",{variant:"info",preventDuplicate:!0})}),[P,k,n,l]),I=Object(a.useCallback)((function(){i(k)}),[k,i]);return Object(r.jsxs)("form",{onSubmit:w((function(e){return A(e)})),style:{maxWidth:"100%",width:"60ch"},children:[Object(r.jsx)(nt.a,{className:t.phaseInstructionLabel,variant:"body1",color:"secondary",children:"1) Select how many months to extend by"}),Object(r.jsxs)(Je.a,{select:!0,SelectProps:{native:!0},name:"subscriptionOption",label:"Initial Subscription",title:"",variant:"outlined",value:f,onChange:function(e){b(!0),O(parseInt(e.target.value))},required:!0,inputRef:S,fullWidth:!0,className:t.textField,children:[Object(r.jsxs)("option",{value:1,children:["1 month extension - ",(1*s).toLocaleString()," ","ORBS"]}),Object(r.jsxs)("option",{value:3,children:["3 months extension - ",(3*s).toLocaleString()," ","ORBS"]}),Object(r.jsxs)("option",{value:6,children:["6 months extension - ",(6*s).toLocaleString()," ","ORBS"]})]}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)(nt.a,{className:t.phaseInstructionLabel,variant:"body1",color:"secondary",children:"2) Allow usage of your ORBS"}),Object(r.jsxs)(nt.a,{variant:"caption",children:["Current allowance : ",o,"/",k]}),Object(r.jsx)(Qe.a,{className:t.actionButton,variant:"outlined",fullWidth:!0,onClick:I,disabled:c||P,startIcon:P?Object(r.jsx)(at.a,{}):null,children:P?"Sufficient allowance":"Approve usage of your ORBS"}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)(nt.a,{className:t.phaseInstructionLabel,variant:"body1",color:"secondary",children:"3) Extend your subscription"}),Object(r.jsx)(Qe.a,{className:t.actionButton,variant:"outlined",fullWidth:!0,type:"submit",disabled:c,children:"Extend VC subscription"})]})}));function Wt(e){var t=Object(a.useState)(!0),n=Object(Ie.a)(t,2),r=n[0],c=n[1],o=Object(a.useState)(!1),i=Object(Ie.a)(o,2),s=i[0],l=i[1],u=Object(a.useState)(null),d=Object(Ie.a)(u,2),b=d[0],p=d[1],h=lt(),j=Object(a.useCallback)(function(){var e=Object(z.a)(U.a.mark((function e(t){var n,r;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log({id:t}),e.next=3,h.readVcData(t);case 3:if("0"!==(n=e.sent).genRefTime){e.next=6;break}return e.abrupt("return",null);case 6:return r={id:t,owner:n.owner,isCertified:n.isCertified,genRefTime:n.genRefTime,rate:n.rate,tier:n.tier,name:n.name,payedUntil:parseInt(n.expiresAt),deploymentSubset:n.deploymentSubset},e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[h]);return Object(a.useEffect)((function(){c(!0),l(!1),j(e).then((function(e){c(!1),p(e)})).catch((function(){c(!1),l(!0)}))}),[j,e]),{errorFindingVc:s,isLoading:r,vcData:b}}var Nt,Vt=n(159),Bt=n.n(Vt),Ft=Object(ce.c)((function(e){var t=bt(),n=dt(),c=Object(he.b)().enqueueSnackbar,o=Object(Oe.c)("vcId",Oe.b),i=Object(Ie.a)(o,2),s=i[0],l=i[1],u=s||"",d=Wt(u),b=d.vcData,p=d.errorFindingVc,h=d.isLoading,j=Object(fe.f)(),m=Bt()(),f=Object(a.useState)(!1),O=Object(Ie.a)(f,2),v=O[0],x=O[1],g=Object(a.useState)((function(){return function(){return console.log("Accepted")}})),y=Object(Ie.a)(g,2),C=y[0],S=y[1],w=Object(a.useState)({title:"",content:""}),k=Object(Ie.a)(w,2),P=k[0],A=k[1],I=Object(a.useCallback)((function(e){l(e)}),[l]),T=Object(a.useCallback)((function(e){t.setAllowanceForStakingContract(ee(e))}),[t]),E=Object(a.useCallback)((function(e){A({title:"Set allowance of ".concat(e," ORBS"),content:'Please click "Allow" and accept the transaction.',acceptText:"Allow",onCancelMessage:"Action canceled"}),x(!0),S((function(){return function(){return T(e)}}))}),[T]),D=Object(a.useCallback)(function(){var e=Object(z.a)(U.a.mark((function e(n){var r;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={amountInFullOrbs:n,vcId:u},e.prev=1,e.next=4,t.extendExistingVcSubscription(r);case 4:c("Subscription extended !",{variant:"success"}),j.push("".concat(kt,"/").concat(s)),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(e.t0),c("TX Error !",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),[c,j,t,s,u]),R=0===u.length,L=null!==b&&b.owner===n.mainAddress,M=Object(a.useMemo)((function(){return R?null:h?Object(r.jsx)(nt.a,{children:"Loading..."}):p?Object(r.jsxs)(nt.a,{variant:"h3",color:"error",children:["Error finding Virtual Chain ",s]}):null==b?Object(r.jsx)(r.Fragment,{children:Object(r.jsxs)(nt.a,{variant:"h3",style:{color:m.palette.warning.main},children:["Could not find VC with id ",s]})}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("br",{}),Object(r.jsx)(Rt,{paidUntil:b.payedUntil,vcName:b.name,vcId:b.id,deploymentSubset:b.deploymentSubset}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),L&&Object(r.jsx)(Mt,{monthlyRateInFullOrbs:t.mspContractParameters.monthlyRateInFullOrbs,setMSPContractAllowance:E,allowanceToMSPContract:t.allowanceToMSPContract,extendVcSubscription:D,disableActionButtons:t.txPending}),!L&&Object(r.jsx)(nt.a,{variant:"h5",style:{color:m.palette.warning.main},children:"Read-only mode"})]})}),[p,D,h,L,t.allowanceToMSPContract,t.mspContractParameters.monthlyRateInFullOrbs,t.txPending,R,E,m.palette.warning.main,b,s]);return Object(r.jsxs)(qe,{style:{textAlign:"center"},children:[R&&Object(r.jsx)(It,{onActionClick:I,actionButtonText:"Open"}),M,Object(r.jsx)(gt,{open:v,onAccept:function(){x(!1),C()},onCancel:function(){x(!1),P.onCancelMessage&&c(P.onCancelMessage,{variant:"info",preventDuplicate:!0})},title:P.title,contentText:P.content})]})})),_t=vt()((function(e){return{actionButton:{transition:"background-color 0.4s linear, color 0.2s linear","&:hover":{backgroundColor:e.palette.secondary.light,color:e.palette.getContrastText(e.palette.secondary.light)}}}})),Ut=c.a.memo((function(e){var t=e.children,n=e.fullWidth,a=Object(ze.a)(e,["children","fullWidth"]),c=_t();return Object(r.jsx)(Qe.a,Object(B.a)(Object(B.a)({className:c.actionButton,variant:"outlined",fullWidth:void 0===n||n,type:"submit"},a),{},{children:t}))})),zt=n(736),Ht=n(737),qt=n(738),Kt=n(325),Yt=n(323),Gt=n.n(Yt),Jt=Object(oe.a)((function(e){return{root:{width:"".concat(15,"rem"),maxWidth:"100%",transition:"0.5s","&:hover":{backgroundColor:Gt()(e.palette.background.paper).lighten(.3).hex()}},bullet:{display:"inline-block",margin:"0 2px",transform:"scale(0.8)"},title:{fontSize:14},pos:{marginBottom:12}}})),Xt=c.a.memo((function(e){var t=Jt(),n=e.vcId,c=e.vcData,o=e.onOpenPageClick,i=Object(a.useRef)(),s=Object(Kt.a)(i),l=Bt()(),u=(t.bullet,"".concat(n," - ").concat(null===c||void 0===c?void 0:c.name," - ").concat(null===c||void 0===c?void 0:c.expiresAt),s?l.palette.secondary.dark:l.palette.text.secondary),d=s?l.palette.secondary.main:"inherit";s&&l.palette.secondary.dark;return Object(r.jsxs)(zt.a,{className:t.root,ref:i,children:[Object(r.jsxs)(Ht.a,{children:[Object(r.jsx)(nt.a,{className:t.title,gutterBottom:!0,style:{color:u},children:n}),Object(r.jsx)(nt.a,{variant:"h5",component:"h2",style:{color:d},children:c.name}),Object(r.jsxs)(nt.a,{variant:"caption",className:t.pos,style:{color:u},children:[Object(r.jsxs)(nt.a,{variant:"caption",component:"span",style:{fontWeight:"bold"},children:["Paid until :"," "]})," ",new Date(1e3*parseInt(c.expiresAt)).toLocaleString(void 0,{year:"numeric",month:"long",day:"numeric"})]}),Object(r.jsx)("br",{}),Object(r.jsx)(nt.a,{variant:"caption",className:t.pos,style:{color:u,fontWeight:"bold"},children:c.isCertified?"Certified":"Not certified"}),Object(r.jsx)("br",{}),Object(r.jsxs)(nt.a,{variant:"caption",className:t.pos,style:{color:u},children:[Object(r.jsxs)(nt.a,{variant:"caption",component:"span",style:{fontWeight:"bold"},children:["Deployment subset :"," "]})," ",c.deploymentSubset]}),Object(r.jsx)("br",{}),Object(r.jsxs)(nt.a,{variant:"caption",className:t.pos,style:{color:u},children:[Object(r.jsxs)(nt.a,{variant:"caption",component:"span",style:{fontWeight:"bold"},children:["rate :"," "]}),Z(c.rate)," ORBS / Month"]}),Object(r.jsx)("br",{}),Object(r.jsxs)(nt.a,{variant:"caption",className:t.pos,style:{color:u},children:[Object(r.jsxs)(nt.a,{variant:"caption",component:"span",style:{fontWeight:"bold"},children:["tier :"," "]}),c.tier]})]}),Object(r.jsx)(qt.a,{style:{marginTop:"auto"},children:Object(r.jsx)(Ut,{style:{marginTop:"auto"},size:"small",onClick:function(){return o(n)},children:"Open VC page"})})]})})),$t={tier:"",rate:"",genRefTime:"",isCertified:!1,owner:"",deploymentSubset:"",expiresAt:"",name:""},Qt=Object(ce.c)((function(e){var t=lt(),n=dt(),c=bt(),o=Object(a.useState)(!1),i=Object(Ie.a)(o,2),s=i[0],l=i[1],u=Object(a.useState)(!1),d=Object(Ie.a)(u,2),b=d[0],p=d[1],h=(c.vcCreationEvents.length,Object(fe.f)()),j=Object(a.useCallback)((function(e){h.push("".concat(Ct,"?vcId=").concat(e))}),[h]),m=Object(a.useCallback)(function(){var e=Object(z.a)(U.a.mark((function e(n){var r;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Looking for vcs for ".concat(n)),e.next=3,t.readVcCreatedEvents(n);case 3:r=e.sent,console.log({createdVcs:r}),c.setVcCreationEventsAndUpdateVcsData(r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[c,t]),f=Object(a.useCallback)(function(){var e=Object(z.a)(U.a.mark((function e(t){return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return p(!0),e.prev=3,e.next=6,m(n.mainAddress);case 6:e.next=12;break;case 8:e.prev=8,e.t0=e.catch(3),console.error('Error while set-n-read vcs " '.concat(e.t0)),l(!0);case 12:return e.prev=12,p(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[3,8,12,15]])})));return function(t){return e.apply(this,arguments)}}(),[n.mainAddress,m]);return Object(a.useEffect)((function(){c.vcCreationEvents.length||(console.log("Runn effect for ".concat(n.mainAddress)),f(n.mainAddress))}),[n.mainAddress,c.vcCreationEvents.length,f]),b?Object(r.jsx)(qe,{children:Object(r.jsx)(nt.a,{variant:"h4",children:"Looking for VCs..."})}):s?Object(r.jsxs)(qe,{children:[Object(r.jsx)(nt.a,{variant:"h4",color:"error",children:"Error while looking for created VCs"}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)(Ut,{onClick:function(){console.log("Re reading"),f(n.mainAddress)},children:"Reload VC's"})]}):Object(r.jsxs)(qe,{style:{},children:[Object(r.jsx)(nt.a,{variant:"h2",children:"Recover VC Page"}),Object(r.jsx)("br",{}),Object(r.jsxs)(nt.a,{variant:"h4",children:["Found ",c.vcCreationEvents.length," vcs created by you"]}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)(Ut,{fullWidth:!1,onClick:function(){console.log("Re reading"),f(n.mainAddress)},children:"Reload VC's"}),Object(r.jsx)("br",{}),Object(r.jsx)("div",{style:{display:"grid",width:"".concat(32,"rem"),maxWidth:"100%",gridTemplateColumns:"repeat(auto-fill, minmax(15rem, 1fr))",gridGap:"1rem",justifyItems:"center"},children:c.vcCreationEvents.map((function(e){var t=c.vcIdToData.get(e.vcId);return Object(r.jsx)(Xt,{vcId:e.vcId,vcData:t||$t,onOpenPageClick:j},e.vcId)}))}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{})]})})),Zt=c.a.memo((function(e){var t=Object(Ce.a)(),n=Object(fe.g)().vcId,a=Wt(n),c=a.vcData,o=a.errorFindingVc;return a.isLoading?Object(r.jsx)(qe,{children:Object(r.jsx)(Ye,{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:Object(r.jsx)(nt.a,{variant:"h3",style:{color:t.palette.error.main},children:"Loading..."})})}):null===c?Object(r.jsx)(qe,{children:Object(r.jsx)(Ye,{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:Object(r.jsxs)(nt.a,{variant:"h3",style:{color:t.palette.warning.main},children:["Could Not find VC ",n]})})}):o?Object(r.jsx)(qe,{children:Object(r.jsxs)(Ye,{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[Object(r.jsx)(nt.a,{variant:"h3",style:{color:t.palette.error.main},children:"Error finding Virtual chain"}),Object(r.jsx)(nt.a,{variant:"h3",children:n})]})}):Object(r.jsx)(qe,{children:Object(r.jsxs)(Ye,{children:[Object(r.jsxs)("div",{style:{padding:"0.5rem",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",marginRight:"auto",marginLeft:"auto"},children:[Object(r.jsx)(Rt,{vcId:n,vcName:c.name,paidUntil:c.payedUntil,deploymentSubset:c.deploymentSubset})," "]}),Object(r.jsxs)("div",{style:{padding:"0.5rem",width:"fit-content",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[Object(r.jsx)(nt.a,{variant:"h4",color:"secondary",style:{fontWeight:"bold"},children:"Important:"}),Object(r.jsx)(nt.a,{variant:"h4",children:"Please keep the virtual Chain ID for future use."})]})]})})})),en=c.a.memo((function(e){var t=Object(Ce.a)(),n=Object(fe.g)().vcId,a=Wt(n),c=a.vcData,o=a.errorFindingVc;return a.isLoading?Object(r.jsx)(qe,{children:Object(r.jsx)(Ye,{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:Object(r.jsx)(nt.a,{variant:"h3",style:{color:t.palette.error.main},children:"Loading..."})})}):null==c?Object(r.jsx)(qe,{children:Object(r.jsx)(Ye,{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:Object(r.jsxs)(nt.a,{variant:"h3",style:{color:t.palette.warning.main},children:["Could Not find VC ",n]})})}):o?Object(r.jsx)(qe,{children:Object(r.jsxs)(Ye,{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[Object(r.jsx)(nt.a,{variant:"h3",style:{color:t.palette.error.main},children:"Error finding Virtual chain"}),Object(r.jsx)(nt.a,{variant:"h3",children:n})]})}):Object(r.jsx)(qe,{children:Object(r.jsxs)(Ye,{children:[Object(r.jsx)("div",{style:{padding:"0.5rem",width:"fit-content",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:Object(r.jsx)(nt.a,{variant:"h4",children:"Vc subscription successfully extended !"})}),Object(r.jsx)("div",{style:{padding:"0.5rem",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",marginRight:"auto",marginLeft:"auto"},children:Object(r.jsx)(Rt,{vcId:n,vcName:c.name,paidUntil:c.payedUntil,deploymentSubset:c.deploymentSubset})})]})})})),tn=n(324),nn=Object(oe.a)((function(e){return{link:{color:e.palette.secondary.light,"&:hover":{color:e.palette.secondary.main}}}})),rn=c.a.memo((function(e){var t=nn(),n=e.text,a=e.href,c=Object(ze.a)(e,["text","href"]);return Object(r.jsx)("a",Object(B.a)(Object(B.a)({className:t.link,href:a||"",target:"_blank",rel:"noopener noreferrer"},c),{},{children:n}))})),an=Object(oe.a)((function(e){return{noEthereumProviderSection:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",padding:"2em",backgroundColor:"rgba(0,0,0, 0.2)",borderRadius:"5%",width:"fit-content",maxWidth:"100%",boxSizing:"border-box"}}})),cn=c.a.memo((function(e){var t=an(),n=e.walletConnectionPhase,a=e.actionFunction,c=(e.pressedOnInstall,Object(Ne.a)(!1)),o="connect"===n,i=!o||c.value,s="install"===n,l=s?"No Ethereum provider detected":"Please connect",u=s?"you should install MetaMask and refresh the page":"To begin, connect your wallet",d="install"===n?"Install":"Connect",b=Object(tn.renderToString)(Object(r.jsx)(se.a,{theme:pe,children:Object(r.jsxs)(nt.a,{children:["I agree to the"," ",Object(r.jsx)(rn,{href:re.termsOfUseUrl,text:"Terms of Use"})," and"," ",Object(r.jsx)(rn,{href:re.privacyPolicyUrl,text:"Privacy Policy"})]})}));return Object(r.jsxs)("div",{className:t.noEthereumProviderSection,children:[Object(r.jsx)(nt.a,{style:{marginBottom:"0.5rem"},variant:"h4",children:l}),Object(r.jsx)(nt.a,{style:{marginBottom:"1rem"},children:u}),Object(r.jsx)(Qe.a,{variant:"outlined",onClick:a,disabled:!i,children:d}),o&&Object(r.jsx)(Xe.a,{style:{marginTop:"0.5rem"},control:Object(r.jsx)($e.a,{checked:c.value,onChange:function(e){return c.setValue(e.target.checked)},name:"legalTicker"}),label:Object(r.jsx)(nt.a,{dangerouslySetInnerHTML:{__html:b}})})]})})),on=Object(oe.a)((function(e){return{appMain:{height:"100%",maxWidth:"90%",boxSizing:"border-box",padding:e.spacing(2)},headerSeparator:{height:"".concat(6,"rem")},mainWrapper:{backgroundColor:"#06142e",backgroundRepeat:"repeat-y",backgroundImage:"url(https://www.orbs.com/wp-content/uploads/2019/02/technology-background1.png)",backgroundAttachment:"scroll",backgroundPosition:"top center",minHeight:"calc(100% - ".concat(6,"rem)"),display:"flex",flexDirection:"column",alignItems:"center"},drawer:{width:240,flexShrink:0},drawerPaper:{width:240},drawerContainer:{overflow:"auto"}}})),sn=Object(ce.c)((function(){var e=on(),t=(Object(Ce.a)(),dt()),n=t.isConnectedToWallet,c=Object(a.useMemo)((function(){return n?Object(r.jsxs)(fe.c,{children:[Object(r.jsx)(fe.a,{exact:!0,path:yt,component:Pt}),Object(r.jsx)(fe.a,{exact:!0,path:Ct,component:Ft}),Object(r.jsx)(fe.a,{exact:!0,path:St,component:Qt}),Object(r.jsx)(fe.a,{path:"".concat(wt,"/:vcId"),component:Zt}),Object(r.jsx)(fe.a,{path:"".concat(kt,"/:vcId"),component:en}),Object(r.jsx)(fe.a,{path:"/",component:Pt})]}):Object(r.jsx)(qe,{children:Object(r.jsx)(cn,{walletConnectionPhase:"connect",actionFunction:function(){return t.askToConnect()}})})}),[t,n]);return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Ue,{}),Object(r.jsx)("div",{className:e.headerSeparator}),Object(r.jsx)("div",{className:e.mainWrapper,children:Object(r.jsx)("main",{className:e.appMain,children:c})})]})})),ln=Object(oe.a)((function(e){return{appMain:{height:"100%",maxWidth:"90%",boxSizing:"border-box",padding:e.spacing(2)},mainWrapper:{backgroundColor:"#06142e",backgroundRepeat:"repeat-y",backgroundImage:"url(https://www.orbs.com/wp-content/uploads/2019/02/technology-background1.png)",backgroundAttachment:"scroll",backgroundPosition:"top center",minHeight:"100%",display:"flex",flexDirection:"column",alignItems:"center"}}})),un=c.a.memo((function(e){var t=ln(),n=Object(Ne.a)(!1),c=Object(a.useCallback)((function(){window.open("https://metamask.io/","_blank"),n.setTrue()}),[n]);return Object(r.jsx)("div",{className:t.mainWrapper,children:Object(r.jsx)("main",{className:t.appMain,children:Object(r.jsx)(qe,{children:Object(r.jsx)(cn,{actionFunction:c,pressedOnInstall:n.value,walletConnectionPhase:"install"})})})})}));Nt=!!window.ethereum?Object(r.jsx)(sn,{}):Object(r.jsx)(un,{}),i.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(ye,{appComponent:Nt})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[688,1,2]]]);
//# sourceMappingURL=main.435d973f.chunk.js.map